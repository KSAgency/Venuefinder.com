function searchLocation(e,t){var i=Ti.UI.createView({width:Ti.UI.FILL,height:Ti.UI.FILL});if(Titanium.Geolocation.purpose="Pinpoint you on the map",Titanium.Geolocation.accuracy=Titanium.Geolocation.ACCURACY_BEST,Titanium.Geolocation.frequency=5e3,"Android"!=Ti.App.Properties.getString("osname")){var a=Titanium.UI.createButton({title:"Near Me"});t.setRightNavButton(a)}else{var n=Titanium.UI.createView({width:Ti.UI.FILL,height:90,top:0}),a=Titanium.UI.createImageView({image:"/images/button_search_near.png",top:10,width:300,height:54}),r=Titanium.UI.createLabel({text:"or, fill out the form below",color:"#666",width:300,textAlign:"center",font:{fontFamily:"Arial",fontSize:14},top:70});n.add(a),n.add(r)}a.addEventListener("click",function(){var t=require("/builders/startActInd"),a=t(i);if(1==Ti.Network.online){var n=require("/builders/databaseFunctions/createDatabase"),r=(n("/venuefinder.db","venuefinder"),require("/builders/createMapView")),o=r(e,null,"Venue Map",!0,"Search","Search by Location","Geolocation",null),s=require("/builders/createApplicationWindow"),l=(s(e,o,"Venue Map","#d2e8f5","Map","Geolocation","",""),require("/builders/endActInd"));l(i,a[0],a[1])}else{var d=Titanium.UI.createAlertDialog({title:"No Internet Connection",message:"Due to the fact that your internet is currently offline, we could not recieve your location. Please use the form below to view venues based on their location."});d.show();{var l=require("/builders/endActInd");l(i,a[0],a[1])}}});var o=Titanium.UI.createView({height:Ti.UI.SIZE,width:Ti.UI.FILL});if("iPad"==Ti.App.Properties.getString("osname")){var s=Titanium.UI.createImageView({image:"/images/imageBanner.png",width:"600",top:"50",zIndex:"2"}),l=Titanium.UI.createView({height:"0"});o.add(s),o.add(l)}else o.setHeight(10);var d=[],c=require("/builders/databaseFunctions/createCountryCountyList"),u=c(e),f=require("/builders/databaseFunctions/createDoubleField"),p=f("Venue Town","Example Town");d.push(u[0]),d.push(u[1]),d.push(p[0]);var m=require("/builders/submitButtonStyle"),g=m();g.addEventListener("click",function(){var t=Titanium.UI.createView({width:"40%",height:"30%",backgroundColor:"#000",opacity:"0.75",borderRadius:"15%",zIndex:"20"}),a=Titanium.UI.createActivityIndicator({style:Titanium.UI.iPhone.ActivityIndicatorStyle.DEFAULT});i.add(t),t.add(a),a.show(),i.setTouchEnabled(!1);var n=p[1].getValue(),r="SELECT * FROM Venue JOIN VenueCoords ON Venue.VenueID=VenueCoords.VenueID WHERE VenueCoords.Latitude IS NOT NULL",o="",s="",l="",d=null;if("Choose a Country"!=u[0].title&&"United Kingdom"!=u[0].title)var o=' AND Country="'+u[0].title+'"',d=!0;if("United Kingdom"==u[0].title)var o=' AND (Country="United Kingdom" OR Country="England" OR Country="Scotland" OR Country="Wales" OR Country="Northern Ireland" OR Country="Channel Islands" OR Country="Isle of Man")',d=!0;if("Choose a County"!=u[1].title)var s=' AND County="'+u[1].title+'"',d=!0;if(""!=n)var l=' AND Town LIKE "%'+n+'%"',d=!0;var c=r+o+s+l,f=require("/builders/createResultsPage"),m=f(i,e,c,d,t,a,!0,!1);e.activeTab.open(m)});var h=Titanium.UI.createTableView({style:Titanium.UI.iPhone.TableViewStyle.GROUPED,data:d,backgroundColor:"#d2e8f5",headerView:o,footerView:g,top:0,scrollable:!0});"iPhone"==Ti.App.Properties.getString("osname")&&h.setWidth(300),"Android"==Ti.App.Properties.getString("osname")&&(h.setWidth(300),h.setTop(10),h.setHeaderView(n)),"iPad"==Ti.App.Properties.getString("osname")&&(h.setWidth(600),h.setScrollable(!1),h.setHeight("100%")),i.add(h);var v=require("/builders/createAdvert"),b=v();return i.add(b),i}module.exports=searchLocation;