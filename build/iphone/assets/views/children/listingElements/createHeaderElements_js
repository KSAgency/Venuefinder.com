function createHeaderElements(e,t,i,n,a){function r(){var e=require("/builders/databaseFunctions/createDatabase"),t=e("/favourites.db","favourites"),i=t.execute('SELECT * FROM Favourites WHERE VenueID="'+n+'"');if(i.isValidRow())var a=i.fieldByName("VenueID");d=a,t.close()}function s(){if(d!=n){var e=Titanium.UI.createAlertDialog({message:"Would you like to rate this venue?",buttonNames:["Not Now","Rate"]});e.show(),e.addEventListener("click",function(e){if(0==e.index){{var i=require("/builders/databaseFunctions/createDatabase"),a=i("/favourites.db","favourites");a.execute('INSERT INTO Favourites ("VenueID", "VenueName", "AddressLine1", "AddressLine2", "Town", "County", "Country", "Postcode", "PackageCode") VALUES ("'+n+'", "'+g+'", "'+m+'", "'+h+'", "'+v+'", "'+b+'", "'+T+'", "'+w+'", "'+p+'")')}a.close(),P.setImage("/images/add_favourites_dslctd.png")}else{var r=[];r[0]=Ti.UI.createPickerRow({title:"Please select a rating",value:"0"}),r[1]=Ti.UI.createPickerRow({title:"5 - Excellent",value:"5"}),r[2]=Ti.UI.createPickerRow({title:"4 - Very Good",value:"4"}),r[3]=Ti.UI.createPickerRow({title:"3 - Good",value:"3"}),r[4]=Ti.UI.createPickerRow({title:"2 - Average",value:"2"}),r[5]=Ti.UI.createPickerRow({title:"1 - Poor",value:"1"});var s=Ti.UI.createPicker({bottom:0,width:Ti.UI.FILL,selectionIndicator:!0,type:Ti.UI.PICKER_TYPE_PLAIN,zIndex:20,backgroundColor:"#399ad4"});if(s.add(r),t.add(s),"Android"!=Ti.App.Properties.getString("osname")){var o=Titanium.UI.createLabel({text:"Done",color:"#FFF"}),l=Titanium.UI.createButton({systemButton:Titanium.UI.iPhone.SystemButton.FLEXIBLE_SPACE}),d=Titanium.UI.iOS.createToolbar({items:[l,o],bottom:"215",borderTop:!0,borderBottom:!0,barColor:"#2195be",zIndex:"10"});t.add(d),o.addEventListener("click",function(){{var e=s.getSelectedRow(0).value,i=require("/builders/databaseFunctions/createDatabase"),a=i("/favourites.db","favourites");a.execute('INSERT INTO Favourites ("VenueID", "VenueName", "StarRating", "AddressLine1", "AddressLine2", "Town", "County", "Country", "Postcode", "PackageCode") VALUES ("'+n+'", "'+g+'", "'+e+'", "'+m+'", "'+h+'", "'+v+'", "'+b+'", "'+T+'", "'+w+'", "'+p+'")')}a.close(),t.remove(s),P.setImage("/images/add_favourites_dslctd.png"),t.remove(d)})}else s.addEventListener("change",function(){var e=s.getSelectedRow(0).value;if("0"!=e){{var i=require("/builders/databaseFunctions/createDatabase"),a=i("/favourites.db","favourites");a.execute('INSERT INTO Favourites ("VenueID", "VenueName", "StarRating", "AddressLine1", "AddressLine2", "Town", "County", "Country", "Postcode", "PackageCode") VALUES ("'+n+'", "'+g+'", "'+e+'", "'+m+'", "'+h+'", "'+v+'", "'+b+'", "'+T+'", "'+w+'", "'+p+'")')}a.close(),t.remove(s),P.setImage("/images/add_favourites_dslctd.png")}})}})}}function o(){var i=require("/builders/startActInd"),a=i(t);t.setTouchEnabled(!1);{var r='SELECT * FROM Venue JOIN VenueCoords ON Venue.VenueID=VenueCoords.VenueID WHERE VenueCoords.VenueID ="'+n+'"',s=require("/builders/createMapView"),o=s(e,r,"Venue Map",!1,"Venue Listing","Show on Map",null,null),l=require("/builders/createApplicationWindow"),d=(l(e,o,"Venue Map","#d2e8f5","Venue Listing","Show On Map","",""),require("/builders/endActInd"));d(t,a[0],a[1])}t.setTouchEnabled(!0)}var l=Ti.UI.createView({width:Ti.UI.FILL,height:Ti.UI.SIZE,layout:"vertical"}),d=null;r();var c=require("/builders/databaseFunctions/createDatabase"),u=c("/venuefinder.db","venuefinder"),f=u.execute('SELECT * FROM Venue WHERE VenueID="'+n+'"');if(f.isValidRow())var n=f.fieldByName("VenueID"),p=f.fieldByName("PackageCode"),g=f.fieldByName("VenueName"),m=f.fieldByName("AddressLine1"),h=f.fieldByName("AddressLine2"),v=f.fieldByName("Town"),b=f.fieldByName("County"),T=f.fieldByName("Country"),w=f.fieldByName("Postcode"),I=f.fieldByName("Tel"),y=f.fieldByName("BookingURL");var _="No description could be found for this venue.";if("PRE"==p){var x=u.execute('SELECT Text FROM VenueAdvertOptionsForWeb WHERE VenueID="'+n+'" AND OptionCode="SG2"');x.isValidRow()&&(_=x.fieldByName("Text"))}else{var x=u.execute('SELECT DescriptionText FROM VenueTextForWeb WHERE VenueID="'+n+'"');x.isValidRow()&&(_=x.fieldByName("DescriptionText"))}(null==_||""==_)&&(_="No description could be retrieved for this venue."),_.replace("/<(?:.|\n)*?>/gm","");var E=require("/builders/todaysDate"),k=E(),S=u.execute('SELECT * FROM Offers WHERE EntryType="V" AND EntryID="'+n+'" AND validToDate>="'+k+'" LIMIT 25');if(S.isValidRow())var A=S.fieldByName("EntryID");if(u.close(),"iPad"!=Ti.App.Properties.getString("osname")){var c=require("/builders/databaseFunctions/createDatabase"),u=c("/venuefinder.db","venuefinder"),L=u.execute('SELECT * FROM VenueAdvertOptionsForWeb WHERE VenueID="'+n+'" AND (OptionCode="TOP" OR OptionCode="PIC")');if(L.isValidRow())var C=L.fieldByName("GraphicFileName");u.close();var F=Titanium.UI.createImageView({image:"http://www.venuefinder.com/gallery/"+C,defaultImage:"/images/icon.png",hires:!0,width:"279.5",height:"181"}),V=Titanium.UI.createView({width:125,left:10,height:125,top:20});V.add(F);var U=Titanium.UI.createImageView({image:"/images/featuredbanner_big.png",top:0,left:0});V.add(U),l.add(V)}var P=Titanium.UI.createImageView({image:"/images/add_favourites_dslctd.png",width:25,height:25,top:-125,left:160});"iPad"==Ti.App.Properties.getString("osname")&&(P.setTop("20"),P.setLeft("0")),l.add(P);var O=Titanium.UI.createLabel({text:"Add to favourites",color:"#A2BE1C",top:-25,height:25,font:{fontSize:"14"},left:190});"iPad"==Ti.App.Properties.getString("osname")&&O.setLeft("50"),l.add(O),d!=n&&P.setImage("/images/add_favourites.png"),P.addEventListener("click",function(){r(),s()}),O.addEventListener("click",function(){P.fireEvent("click")});var c=require("/builders/databaseFunctions/createDatabase"),u=c("/venuefinder.db","venuefinder"),N=u.execute('SELECT * FROM VenueCoords WHERE VenueID="'+n+'"');if(N.isValidRow())var D=N.fieldByName("Latitude"),R=N.fieldByName("Longitude");u.close();var q=Titanium.UI.createImageView({image:"/images/show_on_map.png",width:25,height:25,top:7.5,left:160});"iPad"==Ti.App.Properties.getString("osname")&&(q.setLeft("0"),q.setTop("10")),""!=R&&null!=R&&""!=D&&null!=D||(q.setImage("/images/show_on_map_ns.png"),q.setTouchEnabled(!1)),l.add(q);var B=Titanium.UI.createLabel({text:"Show on map",color:"#A2BE1C",top:-25,height:25,font:{fontSize:"14"},left:190});"iPad"==Ti.App.Properties.getString("osname")&&B.setLeft("50"),l.add(B),q.addEventListener("click",function(){o()}),B.addEventListener("click",function(){q.fireEvent("click")});var M=Titanium.UI.createImageView({image:"/images/share_button.png",width:25,height:25,top:7.5,left:160});"iPad"==Ti.App.Properties.getString("osname")&&(M.setLeft("0"),M.setTop("10")),l.add(M);var W=Titanium.UI.createLabel({text:"Share",color:"#A2BE1C",top:-25,height:25,font:{fontSize:"14"},left:190});"iPad"==Ti.App.Properties.getString("osname")&&W.setLeft("50"),l.add(W),M.addEventListener("click",function(){{var t=require("/builders/createEmailer"),i=t(e,null,'<a href="http://www.venuefinder.com/venues/v'+n+'">'+g+"</a></br>",null,g,"Venue Listing","Share Venue",null,null),a=require("/builders/createApplicationWindow");a(e,i,"Share Venue","#d2e8f5","Venue Listing","Share Venue",null,null,null,null)}}),W.addEventListener("click",function(){M.fireEvent("click")});var z=Titanium.UI.createImageView({image:"/images/venue_advice.png",width:25,height:25,top:7.5,left:160});"iPad"==Ti.App.Properties.getString("osname")&&(z.setLeft("0"),z.setTop("10")),l.add(z),z.addEventListener("click",function(){{var t=require("/builders/createApplicationWindow");t(e,"children/venueFindingService","Venue Finding Service","#d2e8f5","Search","Free Venue Finding Service","","")}});var j=Titanium.UI.createLabel({text:"Venue Advice",color:"#A2BE1C",top:-25,height:25,font:{fontSize:"14"},left:190,bottom:5});if("iPad"==Ti.App.Properties.getString("osname")&&j.setLeft("50"),l.add(j),j.addEventListener("click",function(){z.fireEvent("click")}),"FRE"!=p&&"iPad"!=Ti.App.Properties.getString("osname")){var H=Titanium.UI.createImageView({image:"/images/listing_description.png",top:10,width:145,height:37,left:10});"iPad"==Ti.App.Properties.getString("osname")&&(H.setTop("10"),H.setLeft("0")),null==_&&""==_&&H.setImage("/images/listing_description_nctv.png"),l.add(H),H.addEventListener("click",function(){i.removeAllChildren();var e=Titanium.UI.createWebView({html:'<html><body><span style="font-family:Arial; color:#666; font-size:14px; line-height:20pts; font-size:14px;">'+_+"</span></body></html>",top:40,width:Ti.UI.FILL,height:Ti.UI.SIZE});i.add(e)})}if("iPad"!=Ti.App.Properties.getString("osname")){var Y=Titanium.UI.createImageView({image:"/images/listing_call.png",top:-36,width:145,height:37});"FRE"==p?(Y.setTop(10),Y.setLeft(10)):Y.setRight(10),Y.addEventListener("click",function(){var e=Titanium.UI.createWebView({html:'<html><head><script type="text/javascript" src="s_code.js"></script></head><body><script>s.channel="";s.pageName="";s.events="event60";s.prop60="'+g+'";s.eVar60="'+g+'";var s_code=s.t(); if(s_code)document.write(s_code)</script> <script>if(navigator.appVersion.indexOf("MSIE")>=0)document.write(unescape("%3C")+"!-"+"-")</script><noscript><img src="https://cmpi.122.2o7.net/b/ss/cmpivenuefinderappprod/1/H.25.2--NS/0?[AQB]&cdp=3&[AQE]"height="1" width="1" border="0" alt="" /></noscript></body></html>',opacity:"0",width:"0",height:"0",left:"0",right:"0",touchEnabled:!1});t.add(e),I=I.split(" ").join(""),Titanium.Platform.openURL("tel:"+I),alert("Trying to call: "+I+" from venueID: "+n)}),null!=I&&""!=I&&l.add(Y)}var G=Titanium.UI.createImageView({image:"/images/listing_offers.png",top:5,width:145,height:37,left:10});"iPad"==Ti.App.Properties.getString("osname")&&(G.setTop("10"),G.setLeft("0")),G.addEventListener("click",function(){"iPad"!=Ti.App.Properties.getString("osname")?a.fireEvent("click",{tabName:"Special Offers",contentPath:"createOffersTab",nonSelectedImage:"/images/special_offers.png",selectedImage:"/images/special_offers_s.png",touchEnabled:!0}):a.fireEvent("click",{tabName:"Special Offers",contentPath:"createOffersTab",nonSelectedImage:"/images/tab5_ipad.png",selectedImage:"/images/tab5_ipad_s.png",touchEnabled:!0})}),null!=A&&""!=A&&l.add(G);var K=Titanium.UI.createImageView({image:"/images/listing_book.png",top:"-36",width:145,height:37,right:10});return"iPad"==Ti.App.Properties.getString("osname")&&(K.setTop("10"),K.setLeft("0")),null!=y&&""!=y&&l.add(K),"iPad"==Ti.App.Properties.getString("osname")?l:void i.add(l)}module.exports=createHeaderElements;