function offersTab(e,t,i,a){var n=require("/builders/todaysDate"),r=n(),o=require("/builders/databaseFunctions/createDatabase"),s=o("/venuefinder.db","venuefinder"),l=s.execute('SELECT * FROM Offers WHERE EntryID="'+a+'" AND validToDate>="'+r+'"'),d=s.execute('SELECT * FROM Venue WHERE VenueID="'+a+'"'),c=d.fieldByName("VenueName"),u=d.fieldByName("Town"),f=d.fieldByName("Country"),p=Titanium.UI.createLabel({text:c,left:"10",width:"90%",top:"20",ellipsize:!0,color:"#2195be",font:{fontSize:"18",fontWeight:"bold"}}),m=Titanium.UI.createLabel({text:u+", "+f,left:"10",width:"90%",top:"0",ellipsize:!0,color:"#A2BE1C",font:{fontSize:"16"}});for(i.add(p),i.add(m);l.isValidRow();){var g=l.fieldByName("EntryID"),h=s.execute('SELECT * FROM Venue WHERE VenueID="'+g+'"'),c=h.fieldByName("VenueName"),u=h.fieldByName("Town"),f=h.fieldByName("Country"),v=l.fieldByName("summaryText"),b=l.fieldByName("bodyText"),T=l.fieldByName("validFromDate");validForm=T.toString(),T=T.substr(0,10),T=T.split("-");var w=T[0].toString(),I=T[1].toString()-1,y=T[2].toString();T=new Date(w,I,y),T=T.toString(),T=T.substr(0,15);var x=l.fieldByName("validToDate");x=x.toString(),x=x.substr(0,10),x=x.split("-");var E=x[0].toString(),S=x[1].toString()-1,_=x[2].toString();if(x=new Date(E,S,_),x=x.toString(),x=x.substr(0,15),"iPad"!=Ti.App.Properties.getString("osname")){var A=s.execute('SELECT * FROM VenueAdvertOptionsForWeb WHERE VenueID="'+g+'" AND (OptionCode="TOP" OR OptionCode="PIC")'),L=A.fieldByName("GraphicFileName"),k=Titanium.UI.createImageView({image:"http://www.venuefinder.com/adverts/"+L,defaultImage:"/images/icon.png",hires:!0,width:"279",height:"181"});null==L&&(k.setImage("/images/icon.png"),k.setWidth("280"),k.setHeight("181"));var F=Titanium.UI.createView({width:"40%",left:"10",height:"125",top:"20"}),V=Titanium.UI.createImageView({image:"/images/offerbanner_big.png"});F.add(k),F.add(V),i.add(F)}var U=Titanium.UI.createLabel({text:v,left:"10",width:"90%",top:"10",ellipsize:!0,color:"orange",font:{fontSize:"18",fontWeight:"bold"}}),C=Titanium.UI.createLabel({text:"From "+T,left:"10",width:"90%",top:"10",ellipsize:!0,color:"orange",font:{fontSize:"14"}}),N=Titanium.UI.createLabel({text:"To "+x,left:"10",width:"90%",top:"0",ellipsize:!0,color:"orange",font:{fontSize:"14"}}),D=Titanium.UI.createLabel({text:b,left:"10",width:"90%",top:"10",ellipsize:!0,color:"#666666",font:{fontSize:"14"}});i.add(U),i.add(C),i.add(N),i.add(D),l.next()}}module.exports=offersTab;