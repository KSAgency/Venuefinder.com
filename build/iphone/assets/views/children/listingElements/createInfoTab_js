function infoTab(e,t,i,a,n){for(var r=require("/builders/todaysDate"),o=(r(),require("/builders/databaseFunctions/createDatabase")),s=o("/venuefinder.db","venuefinder"),l=s.execute('SELECT * FROM Venue WHERE VenueID="'+a+'"');l.isValidRow();){var a=l.fieldByName("VenueID"),d=(l.fieldByName("PackageCode"),l.fieldByName("VenueName")),c=l.fieldByName("AddressLine1"),u=l.fieldByName("AddressLine2"),f=l.fieldByName("Town"),p=l.fieldByName("County"),m=l.fieldByName("Country"),g=l.fieldByName("Postcode"),h=l.fieldByName("Tel"),v=l.fieldByName("Email"),b=l.fieldByName("URL"),T=l.fieldByName("MaxMeetingCapacity"),w=l.fieldByName("MaxCateringCapacity"),I=l.fieldByName("MeetingRoomsNo"),y=l.fieldByName("BedroomsNo"),x=l.fieldByName("MeetingRoomDisabledAccess"),E=(l.fieldByName("BookingURL"),h.trim());if(E=h.replace(" ",""),E=h.replace(" ",""),E=h.replace(" ",""),E=h.replace(" ",""),E=h.replace(" ",""),""!=c&&null!=c)var c=c+", \n";else var c="";if(""!=u&&null!=u)var u=u+", \n";else var u="";if(""!=f&&null!=f)var S=f+", ",f=f+", \n";else var S="",f="";if(""!=p&&null!=p)var p=p+", \n";else var p="";if(""!=m&&null!=m)var m=m;else var m="";if(""!=g&&null!=g)var g=g+", \n";else var g="";var b=b.toString(),_=b.indexOf("http://");if(-1!=_)var b=b.substr(7,200);var A=s.execute('SELECT * FROM Ratings WHERE VenueID="'+a+'"');if(A.isValidRow())var k=A.fieldByName("Text");var L=s.execute('SELECT * FROM VenueToGroup WHERE VenueID="'+a+'"');if(L.isValidRow())var F=L.fieldByName("GroupCode");var V=s.execute('SELECT * FROM Groups WHERE GroupCode="'+F+'"');if(V.isValidRow())var U=V.fieldByName("Name");var C=s.execute('SELECT * FROM Rates WHERE VenueID="'+a+'"');if(C.isValidRow())var N=C.fieldByName("RateDailyxVat"),D=C.fieldByName("Rate24hrxVat"),P=C.fieldByName("RateMeetingxVat"),O=C.fieldByName("RateMeetingAvailableOnRequest"),B=C.fieldByName("Rate24AvailableOnRequest"),R=C.fieldByName("RateDailyAvailableOnRequest");if(null!=N){var N=N.toString(),N=N.substr(0,5),q=N.lastIndexOf("."),W=N.length;-1!=q?W-q==2&&(N+="0"):N+=".00"}if(null!=D){var D=D.toString(),D=D.substr(0,5),z=D.lastIndexOf("."),M=D.length;-1!=z?M-z==2&&(D+="0"):D+=".00"}if(null!=P){var P=P.toString(),P=P.substr(0,5),j=P.lastIndexOf("."),H=P.length;-1!=j?H-j==2&&(P+="0"):P+=".00"}if("iPad"!=Ti.App.Properties.getString("osname")){var Y=require("/views/children/listingElements/createHeaderElements");Y(e,t,i,a,n)}var G=Titanium.UI.createLabel({text:d,left:10,top:5,width:300,ellipsize:!0,color:"#2195be",font:{fontSize:"18",fontWeight:"bold"}});i.add(G);var K=Titanium.UI.createLabel({text:S+m,left:"10",width:"90%",ellipsize:!0,color:"#A2BE1C",font:{fontSize:"16"}});i.add(K);var X=Titanium.UI.createLabel({text:"Address",color:"#2195be",font:{fontSize:"16",fontFamily:"Arial",fontWeight:"bold"},left:"10",top:"10"});i.add(X);var Z=Titanium.UI.createLabel({text:c+u+f+p+g+m,color:"#666",font:{fontSize:"16",fontFamily:"Arial"},left:"10",width:"90%"});i.add(Z);var Q=Titanium.UI.createLabel({text:"Telephone",color:"#2195be",font:{fontSize:"16",fontFamily:"Arial",fontWeight:"bold"},left:"10",top:"10"}),J=Titanium.UI.createLabel({text:h,color:"#A2BE1C",font:{fontSize:"16",fontFamily:"Arial"},left:"10"});if(i.add(Q),i.add(J),"iPad"!=Ti.App.Properties.getString("osname")){J.addEventListener("click",function(){var e=Titanium.UI.createWebView({html:'<html><head><script type="text/javascript" src="s_code.js"></script></head><body><script>s.channel="";s.pageName="";s.events="event60";s.prop60="'+d+'";s.eVar60="'+d+'";var s_code=s.t(); if(s_code)document.write(s_code)</script> <script>if(navigator.appVersion.indexOf("MSIE")>=0)document.write(unescape("%3C")+"!-"+"-")</script><noscript><img src="https://cmpi.122.2o7.net/b/ss/cmpivenuefinderappprod/1/H.25.2--NS/0?[AQB]&cdp=3&[AQE]"height="1" width="1" border="0" alt="" /></noscript></body></html>',opacity:"0",width:"0",height:"0",left:"0",right:"0",touchEnabled:!1});t.add(e),h=h.split(" ").join(""),Titanium.Platform.openURL("tel:"+h)});var $=Titanium.UI.createButton({backgroundImage:"/images/callButton.png",height:"19",width:"44",top:"-21",left:"135"});i.add($),$.addEventListener("click",function(){var e=Titanium.UI.createWebView({html:'<html><head><script type="text/javascript" src="s_code.js"></script></head><body><script>s.channel="";s.pageName="";s.events="event60";s.prop60="'+d+'";s.eVar60="'+d+'";var s_code=s.t(); if(s_code)document.write(s_code)</script> <script>if(navigator.appVersion.indexOf("MSIE")>=0)document.write(unescape("%3C")+"!-"+"-")</script><noscript><img src="https://cmpi.122.2o7.net/b/ss/cmpivenuefinderappprod/1/H.25.2--NS/0?[AQB]&cdp=3&[AQE]"height="1" width="1" border="0" alt="" /></noscript></body></html>',opacity:"0",width:"0",height:"0",left:"0",right:"0",touchEnabled:!1});t.add(e),E=h.split(" ").join(""),Titanium.Platform.openURL("tel:"+E)})}var et=Titanium.UI.createLabel({text:"Email",color:"#2195be",font:{fontSize:"16",fontFamily:"Arial",fontWeight:"bold"},left:"10",top:"10"}),tt=Titanium.UI.createLabel({text:"Click here to email",color:"#A2BE1C",font:{fontSize:"16",fontFamily:"Arial"},left:"10"});i.add(et),i.add(tt),tt.addEventListener("click",function(){{var t=require("/builders/createEmailer"),i=(t(e,v,null,null,d,null,null,null,null),require("/builders/createApplicationWindow"));i(e,null,"Email a Venue","#d2e8f5","Venue Listing","Email A Venue",null,null,null,null)}});var it=Titanium.UI.createLabel({text:"Website",color:"#2195be",font:{fontSize:"16",fontFamily:"Arial",fontWeight:"bold"},left:"10",top:"10"});i.add(it);var at=Titanium.UI.createLabel({text:"Click here to visit the website",color:"#A2BE1C",font:{fontSize:"16",fontFamily:"Arial"},left:"10"});i.add(at),at.addEventListener("click",function(){var t=require("/builders/createApplicationWindow"),i=t(e,null,"Venue Website","#FFF",null,null,null,null),a=Titanium.UI.createWebView({url:"http://"+b});i.add(a),e.activeTab.open(i)});var nt=Titanium.UI.createLabel({text:"Rating",color:"#2195be",font:{fontSize:"16",fontFamily:"Arial",fontWeight:"bold"},left:"10",top:"10"}),rt=Titanium.UI.createLabel({text:k,color:"#666",font:{fontSize:"16",fontFamily:"Arial"},left:"10"});null!=k&&""!=k&&(i.add(nt),i.add(rt));var ot=Titanium.UI.createLabel({text:"Group",color:"#2195be",font:{fontSize:"16",fontFamily:"Arial",fontWeight:"bold"},left:"10",top:"10"}),st=Titanium.UI.createLabel({text:U,color:"#666",font:{fontSize:"16",fontFamily:"Arial"},left:"10"});""!=U&&null!=U&&(i.add(ot),i.add(st));var lt=Titanium.UI.createLabel({text:"Delegate Rates",color:"#2195be",font:{fontSize:"16",fontFamily:"Arial",fontWeight:"bold"},left:"10",top:"10"}),dt=Titanium.UI.createLabel({text:"Daily Rate: £"+N,color:"#666",font:{fontSize:"16",fontFamily:"Arial"},left:"10"});1==R&&dt.setText("Daily Rate: Available on request");var ct=Titanium.UI.createLabel({text:"24hr Rate: £"+D,color:"#666",font:{fontSize:"16",fontFamily:"Arial"},left:"10"});1==B&&ct.setText("24hr Rate: Available on request");var ut=Titanium.UI.createLabel({text:"Rates are exclusive of sales tax (VAT)",color:"#666",font:{fontSize:"16",fontFamily:"Arial"},left:"10"});i.add(lt),i.add(dt),i.add(ct),i.add(ut);var ft=0;("0.00"===N||""===N||null===N)&&(i.remove(dt),ft+=1),("0.00"===D||""===D||null===D)&&(i.remove(ct),ft+=1),2==ft&&(i.remove(lt),i.remove(ut));var pt=Titanium.UI.createLabel({text:"Room Hire",color:"#2195be",font:{fontSize:"16",fontFamily:"Arial",fontWeight:"bold"},left:"10",top:"10"}),mt=Titanium.UI.createLabel({text:"From: £"+P,color:"#666",font:{fontSize:"16",fontFamily:"Arial"},left:"10"});1==O&&mt.setText("Rate: Available on request");var gt=Titanium.UI.createLabel({text:"Rates are exclusive of sales tax (VAT)",color:"#666",font:{fontSize:"16",fontFamily:"Arial"},left:"10"});""!==P&&"0.00"!==P&&null!==P&&(i.add(pt),i.add(mt),i.add(gt)),"0.00"==P&&1==O&&(i.add(pt),i.add(mt),i.add(gt));var ht=Titanium.UI.createLabel({text:"Meeting Capacity ",color:"#2195be",font:{fontSize:"16",fontFamily:"Arial",fontWeight:"bold"},left:"10",top:"10"}),vt=Titanium.UI.createLabel({text:T+" (Max)",color:"#666",font:{fontSize:"16",fontFamily:"Arial"},left:"10"});""!=T&&"0"!=T&&null!=T&&(i.add(ht),i.add(vt));var bt=Titanium.UI.createLabel({text:"Catering Capacity ",color:"#2195be",font:{fontSize:"16",fontFamily:"Arial",fontWeight:"bold"},left:"10",top:"10"}),Tt=Titanium.UI.createLabel({text:w+" (Max)",color:"#666",font:{fontSize:"16",fontFamily:"Arial"},left:"10"});""!=w&&"0"!=w&&null!=w&&(i.add(bt),i.add(Tt));var wt=Titanium.UI.createLabel({text:"No. of Meeting Rooms ",color:"#2195be",font:{fontSize:"16",fontFamily:"Arial",fontWeight:"bold"},left:"10",top:"10"}),It=Titanium.UI.createLabel({text:I,color:"#666",font:{fontSize:"16",fontFamily:"Arial"},left:"10"});""!=I&&"0"!=I&&null!=I&&(i.add(wt),i.add(It));var yt=Titanium.UI.createLabel({text:"No. of Bedrooms ",color:"#2195be",font:{fontSize:"16",fontFamily:"Arial",fontWeight:"bold"},left:"10",top:"10"}),xt=Titanium.UI.createLabel({text:y,color:"#666",font:{fontSize:"16",fontFamily:"Arial"},left:"10"});if(1==Ti.Network.online&&(xt.setColor("#A2BE1C"),xt.addEventListener("click",function(){var t=require("/builders/createApplicationWindow"),i=t(e,null,"Bedroom Information","#FFF",null,null,null,null);e.activeTab.open(i);var n=Titanium.UI.createScrollView({width:"100%",contentHeight:"auto",top:"0%",layout:"vertical"});"iPad"==Ti.App.Properties.getString("osname")&&n.setWidth("600"),i.add(n);var r=require("/builders/databaseFunctions/createDatabase"),o=r("/venuefinder.db","venuefinder"),s=o.execute('SELECT * FROM Venue WHERE VenueID="'+a+'"'),l=s.fieldByName("VenueName"),d=s.fieldByName("Town"),c=s.fieldByName("Country");if(""!=d&&null!=d)var d=d+", ";else var d="";if(""!=u&&null!=u)var u=u+", ";else var u="";var l=Titanium.UI.createLabel({text:l,left:"10",top:"14",width:"90%",ellipsize:!0,color:"#2195be",font:{fontSize:"18",fontWeight:"bold"}});n.add(l);var f=Titanium.UI.createLabel({text:d+c,left:"10",width:"90%",height:"30",top:"-5",ellipsize:!0,color:"#A2BE1C",font:{fontSize:"16"}});n.add(f);var p=Ti.Network.createHTTPClient();p.open("GET","http://venuefindermobile.live.x-rm.com/webapi-v1/api/venue/"+a+"/bedroomdetails"),p.setRequestHeader("Accept","application/xml"),p.onload=function(){var e=(this.responseXML.documentElement,this.responseXML.getElementsByTagName("Bedrooms4Posters").item(0).text),t=this.responseXML.getElementsByTagName("BedroomsDoubles").item(0).text,i=this.responseXML.getElementsByTagName("BedroomsExecutive").item(0).text,a=this.responseXML.getElementsByTagName("BedroomsFamily").item(0).text,r=this.responseXML.getElementsByTagName("BedroomsKing").item(0).text,o=this.responseXML.getElementsByTagName("BedroomsOffsite").item(0).text,s=this.responseXML.getElementsByTagName("BedroomsSingles").item(0).text,l=this.responseXML.getElementsByTagName("BedroomsStudios").item(0).text,d=this.responseXML.getElementsByTagName("BedroomsSuites").item(0).text,c=this.responseXML.getElementsByTagName("BedroomsTriples").item(0).text,u=this.responseXML.getElementsByTagName("BedroomsTwins").item(0).text,f=Titanium.UI.createLabel({text:"4 Poster Bedroom",color:"#A3BD0B",font:{fontSize:"16",fontFamily:"Arial"},top:"5",left:"10",top:"10"}),p=Titanium.UI.createLabel({text:e,color:"#666",font:{fontSize:"16",fontFamily:"Arial"},top:"-20",right:"10"});null!=e&&0!=e&&"0"!=e&&""!=e&&(n.add(f),n.add(p));var m=Titanium.UI.createLabel({text:"Double Bedroom",color:"#A3BD0B",font:{fontSize:"16",fontFamily:"Arial"},top:"5",left:"10",top:"10"}),g=Titanium.UI.createLabel({text:t,color:"#666",font:{fontSize:"16",fontFamily:"Arial"},top:"-20",right:"10"});null!=t&&0!=t&&"0"!=t&&""!=t&&(n.add(m),n.add(g));var h=Titanium.UI.createLabel({text:"Executive Bedroom",color:"#A3BD0B",font:{fontSize:"16",fontFamily:"Arial"},top:"5",left:"10",top:"10"}),v=Titanium.UI.createLabel({text:i,color:"#666",font:{fontSize:"16",fontFamily:"Arial"},top:"-20",right:"10"});null!=i&&0!=i&&"0"!=i&&""!=i&&(n.add(h),n.add(v));var b=Titanium.UI.createLabel({text:"Family Bedroom",color:"#A3BD0B",font:{fontSize:"16",fontFamily:"Arial"},top:"5",left:"10",top:"10"}),T=Titanium.UI.createLabel({text:a,color:"#666",font:{fontSize:"16",fontFamily:"Arial"},top:"-20",right:"10"});null!=a&&0!=a&&"0"!=a&&""!=a&&(n.add(b),n.add(T));var w=Titanium.UI.createLabel({text:"King Bedroom",color:"#A3BD0B",font:{fontSize:"16",fontFamily:"Arial"},top:"5",left:"10",top:"10"}),I=Titanium.UI.createLabel({text:r,color:"#666",font:{fontSize:"16",fontFamily:"Arial"},top:"-20",right:"10"});null!=r&&0!=r&&"0"!=r&&""!=r&&(n.add(w),n.add(I));var y=Titanium.UI.createLabel({text:"Offsite Bedroom",color:"#A3BD0B",font:{fontSize:"16",fontFamily:"Arial"},top:"5",left:"10",top:"10"}),x=Titanium.UI.createLabel({text:o,color:"#666",font:{fontSize:"16",fontFamily:"Arial"},top:"-20",right:"10"});null!=o&&0!=o&&"0"!=o&&""!=o&&(n.add(y),n.add(x));var E=Titanium.UI.createLabel({text:"Single Bedroom",color:"#A3BD0B",font:{fontSize:"16",fontFamily:"Arial"},top:"5",left:"10",top:"10"}),S=Titanium.UI.createLabel({text:s,color:"#666",font:{fontSize:"16",fontFamily:"Arial"},top:"-20",right:"10"});null!=s&&0!=s&&"0"!=s&&""!=s&&(n.add(E),n.add(S));var _=Titanium.UI.createLabel({text:"Suite Bedroom",color:"#A3BD0B",font:{fontSize:"16",fontFamily:"Arial"},top:"5",left:"10",top:"10"}),A=Titanium.UI.createLabel({text:d,color:"#666",font:{fontSize:"16",fontFamily:"Arial"},top:"-20",right:"10"});null!=d&&0!=d&&"0"!=d&&""!=d&&(n.add(_),n.add(A));var k=Titanium.UI.createLabel({text:"Studio Bedroom",color:"#A3BD0B",font:{fontSize:"16",fontFamily:"Arial"},top:"5",left:"10",top:"10"}),L=Titanium.UI.createLabel({text:l,color:"#666",font:{fontSize:"16",fontFamily:"Arial"},top:"-20",right:"10"});null!=l&&0!=l&&"0"!=l&&""!=l&&(n.add(k),n.add(L));var F=Titanium.UI.createLabel({text:"Triple Bedroom",color:"#A3BD0B",font:{fontSize:"16",fontFamily:"Arial"},top:"5",left:"10",top:"10"}),V=Titanium.UI.createLabel({text:c,color:"#666",font:{fontSize:"16",fontFamily:"Arial"},top:"-20",right:"10"});null!=c&&0!=c&&"0"!=c&&""!=c&&(n.add(F),n.add(V));var U=Titanium.UI.createLabel({text:"Twin Bedroom",color:"#A3BD0B",font:{fontSize:"16",fontFamily:"Arial"},top:"5",left:"10",top:"10"}),C=Titanium.UI.createLabel({text:u,color:"#666",font:{fontSize:"16",fontFamily:"Arial"},top:"-20",right:"10"});null!=u&&0!=u&&"0"!=u&&""!=u&&(n.add(U),n.add(C))},p.send()})),""!=y&&"0"!=y&&null!=y&&(i.add(yt),i.add(xt),1==Titanium.Network.online)){var Et=Titanium.UI.createButton({backgroundImage:"/images/moreButton.png",height:"19",width:"44",top:"-21",left:"70"});i.add(Et),Et.addEventListener("click",function(){xt.fireEvent("click")})}var St=Titanium.UI.createLabel({text:"Meeting Room Disabled Access",color:"#2195be",font:{fontSize:"16",fontFamily:"Arial",fontWeight:"bold"},left:"10",top:"10"});x=1==x?"Yes":"No";var _t=Titanium.UI.createLabel({text:x,color:"#666",font:{fontSize:"16",fontFamily:"Arial"},left:"10"});""!=x&&"0"!=x&&null!=x&&(i.add(St),i.add(_t)),l.next()}}module.exports=infoTab;