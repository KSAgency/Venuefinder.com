function createDetailPage(e,t,i,a){var n;i[2]&&(i=i[2],n="map");for(var r,o,s=dbUtil.getVenueForId(e),l=0;l<t.length;l++)e==t[l].venueID&&(r=t[l+1]?t[l+1].venueID:"0",o=t[l-1]?t[l-1].venueID:"0");var d=createViewBackground();d.add(createBronzeView(s));var u=dbUtil.getVenueForId(r);if(void 0!=u.VenueID){var c=createBronzeView(u);c.setLeft(469),d.add(c)}var f=Ti.UI.createImageView({image:"/images/pageTurnButton",width:"34",right:"0"});"0"!=r&&"map"!=n&&i.add(f);var g=Ti.UI.createImageView({image:"/images/pageTurnButton",width:"34",left:"0",transform:Ti.UI.create2DMatrix({rotate:180})});return"0"!=o&&"map"!=n&&i.add(g),f.addEventListener("click",function(){var e=dbUtil.getVenueForId(r).PackageCode;if("GLD"==e){i.remove(d),i.remove(f),i.remove(g);var n=require("/views/collview/venueDetailPages/createGoldPage"),s=n.createDetailPage(r,t,i,a);i.add(s)}else if("SIL"==e){i.remove(d),i.remove(f),i.remove(g);var n=require("/views/collview/venueDetailPages/createSilverPage"),l=n.createDetailPage(r,t,i,a);i.add(l)}else if("PRE"==e){i.remove(d),i.remove(f),i.remove(g);var n=require("/views/collview/venueDetailPages/createBronzePage"),u=n.createDetailPage(r,r,o,i,a);i.add(u)}}),g.addEventListener("click",function(){var e=dbUtil.getVenueForId(o).PackageCode;if("GLD"==e){i.remove(d),i.remove(f),i.remove(g);var n=require("/views/collview/venueDetailPages/createGoldPage"),r=n.createDetailPage(o,t,i,a);i.add(r)}else if("SIL"==e){i.remove(d),i.remove(f),i.remove(g);var n=require("/views/collview/venueDetailPages/createSilverPage"),s=n.createDetailPage(o,t,i,a);i.add(s)}else if("PRE"==e){i.remove(d),i.remove(f),i.remove(g);var n=require("/views/collview/venueDetailPages/createBronzePage"),l=n.createDetailPage(o,t,i,a);i.add(l)}}),d}function createViewBackground(){var e=Ti.App.Properties.getString("styleName"),t=require("/views/collview/getVenueThumbView"),i=t.setWindowPageStyle(e,!0),a=i[0];return a}function createBronzeView(e){var t=Ti.UI.createView({width:"469",height:"561",top:"74",left:"0",touchEnabled:!0});t.add(createGallery(e));var i=createHeaderElements.createFeaturedButtons(e.VenueID,t);i.setTop(0),t.add(i),t.add(logo(e)),t.add(descText(e));var a=createTitleLocation(e);return t.add(a),t.add(createVenueDetail(e)),t}function createGallery(e){for(var t=createDatabase("/venuefinder.db","venuefinder"),i=t.execute("SELECT * FROM VenueAdvertOptionsForWeb WHERE VenueID='"+e.VenueID+"' AND (OptionCode='TOP' OR OptionCode = 'PIC' OR OptionCode='MID' OR OptionCode='MIL' OR OptionCode='MIR') ORDER BY OrderKey, GraphicFileName ASC"),a=0,n=Ti.UI.createView({width:240,height:195,left:45,top:0,layout:"horizontal"});i.isValidRow();){{var r,o,s,l,d=(i.fieldByName("OptionCode"),i.fieldByName("GraphicFileName"));i.fieldByName("URL")}r=115,o=95,0==a?(l=0,s=0):1==a?(l=10,s=0):2==a?(l=0,s=5):3==a&&(l=10,s=5);var u=Ti.UI.createScrollView({width:r,height:o,top:s,left:l,borderRadius:"0",contentWidth:Ti.UI.FILL,contentHeight:Ti.UI.FILL,scrollingEnabled:!1}),c=Titanium.UI.createImageView({image:"http://www.venuefinder.com/adverts/"+d,defaultImage:"/images/icon.png",index:a,width:Ti.UI.FILL,height:Ti.UI.FILL,left:0,top:0});if(u.add(c),n.add(u),a++,4==a)break;i.next()}return t.close(),n}function logo(e){for(var t=createDatabase("/venuefinder.db","venuefinder"),i=t.execute("SELECT * FROM VenueAdvertOptionsForWeb WHERE VenueID="+e.VenueID+" AND (OptionCode='LG1' OR OptionCode = 'GR1' OR OptionCode = 'SG2' OR OptionCode='AS1') ORDER BY OptionCode DESC"),a=Ti.UI.createView({width:Ti.UI.SIZE,height:Ti.UI.SIZE,top:150,right:5,borderRadius:"0",layout:"horizontal"});i.isValidRow();){var n=Titanium.UI.createImageView({image:"http://www.venuefinder.com/adverts/"+i.fieldByName("GraphicFileName"),defaultImage:"/images/icon.png",width:120,right:10});i.rowCount>1&&(n.setWidth((n.width-n.width/2).toString()),n.setLeft(10)),a.add(n),i.next()}return t.close(),a}function createTitleLocation(e){var t=Ti.UI.createView({top:"210",left:"45",width:400,height:Ti.UI.SIZE,layout:"vertical"}),i=Titanium.UI.createLabel({text:e.VenueName,color:"#000000",top:0,width:Ti.UI.SIZE,left:0,height:Ti.UI.SIZE,font:{fontSize:"28"}}),a=Titanium.UI.createLabel({text:e.Town+", "+e.Country,color:"#000000",width:Ti.UI.SIZE,top:5,left:0,font:{fontSize:"24",fontFamily:Ti.App.Properties.getString("fontFamily")}});return t.add(i),t.add(a),t}function descText(e){var t,i=createDatabase("/venuefinder.db","venuefinder");t="PRE"!=e.PackageCode?'SELECT DescriptionText FROM VenueTextForWeb WHERE VenueID="'+e.VenueID+'"':'SELECT * FROM VenueAdvertOptionsForWeb WHERE VenueID="'+e.VenueID+'" AND OptionCode="SG2"';for(var a,n=i.execute(t);n.isValidRow();)a=n.fieldByName("PRE"!=e.PackageCode?"DescriptionText":"Text"),n.next();(null==a||""==a)&&(a="No description could be retrieved for this venue."),a.replace("/<(?:.|\n)*?>/gm","");var r=Titanium.UI.createWebView({html:'<html><body><span style="font-family:Arial; color:#000; font-size:14px; line-height:20pts; font-size:15px;">'+a+"</span></body></html>",width:185,top:355,left:"40"});return r}function createVenueDetail(e){var t=Ti.UI.createView({width:"205",height:"270",top:320,right:"20",layout:"vertical"}),i=Titanium.UI.createLabel({width:"172",height:"23",top:"0",left:"0",backgroundColor:"transparent",text:"Venue Details",font:{fontSize:"24",fontFamily:Ti.App.Properties.getString("fontFamily")}});t.add(i);var a;a="England"==e.Country||"Scotland"==e.Country||"Northern Ireland"==e.Country||"Wales"==e.Country?e.Tel:"+44 (0)1780 484498";var n="<div>"+e.AddressLine1+"</div><div>"+e.Town+", "+e.Country+",</div><div>"+e.Postcode+"</div><div>Tel: "+a+"</div>",r=Ti.UI.createWebView({html:'<html><body style="margin:0px;"><div style="text-align:left;font-family:'+Ti.App.Properties.getString("fontFamily")+'; color:#000; line-height:18pts; font-size:14px;">'+n+"</div></body></html>",top:"10",left:"0",width:"200",height:Ti.UI.SIZE,disableBounce:!0});t.add(r);var o="Visit website",s=Titanium.UI.iOS.createAttributedString({text:o});s.addAttribute({type:Titanium.UI.iOS.ATTRIBUTE_UNDERLINES_STYLE,value:Titanium.UI.iOS.ATTRIBUTE_UNDERLINE_STYLE_SINGLE,range:[0,o.length]});var l=Titanium.UI.createLabel({color:"#2195be",font:{fontSize:"14",fontFamily:Ti.App.Properties.getString("fontFamily")},left:"0",top:10,height:"15",attributedString:s});t.add(l),l.addEventListener("click",function(){var t=Titanium.UI.createWindow({backgroundColor:"rgba(0,0,0,0.8)"}),i=Titanium.UI.createButton({right:"5%",top:"5%",height:"20",zIndex:1,title:"X",color:"#FFF",font:{fontSize:"28",fontWeight:"bold"}});t.add(i),i.addEventListener("click",function(){t.close()});var a=Ti.UI.createView({width:"80%",height:"80%",top:"10%",left:"10%"}),n=Titanium.UI.createWebView({url:e.URL});a.add(n),t.add(a),t.open()});var d="Email this venue",u=Titanium.UI.iOS.createAttributedString({text:d});u.addAttribute({type:Titanium.UI.iOS.ATTRIBUTE_UNDERLINES_STYLE,value:Titanium.UI.iOS.ATTRIBUTE_UNDERLINE_STYLE_SINGLE,range:[0,d.length]});var c=Titanium.UI.createLabel({text:d,color:"#2195be",font:{fontSize:"14",fontFamily:Ti.App.Properties.getString("fontFamily")},left:"0",top:"5",height:"15",attributedString:u});t.add(c),c.addEventListener("click",function(){var t;t="England"==e.Country||"Scotland"==e.Country||"Northern Ireland"==e.Country||"Wales"==e.Country?e.Email:"VenueFinder@trinityconferences.co.uk";var i=require("/builders/createEmailer"),a=i(null,t,null,null,e.VenueName,null,null,null,null),n=Titanium.UI.createWindow({backgroundColor:"rgba(0,0,0,0.8)"}),r=Titanium.UI.createButton({right:"5%",top:"5%",height:"20",zIndex:1,title:"X",color:"#FFF",font:{fontSize:"28",fontWeight:"bold"}});n.add(r),r.addEventListener("click",function(){n.close()});var o=Ti.UI.createView({width:"80%",height:"80%",top:"10%",left:"10%"});o.add(a),n.add(o),n.open()});var f="<div style='width:190px'>Max catering capacity<span style='float:right;font-weight:bold'>"+e.MaxCateringCapacity+"</span></div>";f+="<div style='width:190px'>Max meeting capacity<span style='float:right;font-weight:bold'>"+e.MaxMeetingCapacity+"</span></div>",f+="<div style='width:190px'>Number of meeting rooms<span style='float:right;font-weight:bold'>"+e.MeetingRoomsNo+"</span></div>",f+="<div style='width:190px'>Number of bedrooms<span style='float:right;font-weight:bold'>"+e.BedroomsNo+"</span></div>";var g=Ti.UI.createWebView({html:'<html><body style="margin:0px;"><div style="left:0px;text-align:left;font-family:'+Ti.App.Properties.getString("fontFamily")+'; color:#000; font-size:12px; line-height:20pts;">'+f+"</div></body></html>",top:"10",left:"0",width:"200",height:"78",disableBounce:!0});return t.add(g),t}var createImageGallery=require("views/collview/ImageGallery/createImageGallery"),createHeaderElements=require("/views/collview/listingElements/createHeaderElementsios"),createDatabase=require("/builders/databaseFunctions/createDatabase"),dbUtil=require("/builders/databaseFunctions/dbUtil");module.exports.createDetailPage=createDetailPage;