function createDetailPage(e,t){var i=dbUtil.getVenueForId(e),a=createViewBackground();a.add(createBronzeView(i));var n=dbUtil.getVenueForId(t),r=createBronzeView(n);return r.setLeft(469),a.add(r),a}function createViewBackground(){var e=Ti.App.Properties.getString("styleName"),t=require("/views/collview/getVenueThumbView"),i=t.setWindowPageStyle(e,!0),a=i[0];return a}function createBronzeView(e){var t=Ti.UI.createView({width:"469",height:"561",top:"74",left:"0"});t.add(createGallery(e));var i=createHeaderElements.createFeaturedButtons(e.VenueID,t);i.setTop(0),t.add(i),t.add(logo(e)),t.add(descText(e));var a=createTitleLocation(e);return t.add(a[0]),t.add(a[1]),t.add(createVenueDetail(e)),t}function createGallery(e){for(var t=createDatabase("/venuefinder.db","venuefinder"),i=t.execute("SELECT * FROM VenueAdvertOptionsForWeb WHERE VenueID='"+e.VenueID+"' AND (OptionCode='MIL' OR OptionCode = 'PIC' ) ORDER BY OrderKey, GraphicFileName ASC"),a=0,n=Ti.UI.createView({width:240,height:195,left:45,top:0,layout:"horizontal"});i.isValidRow();){{var r,o,s,l,d=(i.fieldByName("OptionCode"),i.fieldByName("GraphicFileName"));i.fieldByName("URL")}r=115,o=95,0==a?(l=0,s=0):1==a?(l=10,s=0):2==a?(l=0,s=5):3==a&&(l=10,s=5);var u=Ti.UI.createScrollView({width:r,height:o,top:s,left:l,borderRadius:"0",contentWidth:Ti.UI.FILL,contentHeight:Ti.UI.FILL,scrollingEnabled:!1}),c=Titanium.UI.createImageView({image:"http://www.venuefinder.com/adverts/"+d,defaultImage:"/images/icon.png",index:a,width:Ti.UI.FILL,height:Ti.UI.FILL,left:0,top:0});if(u.add(c),n.add(u),a++,4==a)break;i.next()}return t.close(),n}function logo(e){for(var t,i=createDatabase("/venuefinder.db","venuefinder"),a=i.execute("SELECT * FROM VenueAdvertOptionsForWeb WHERE VenueID="+e.VenueID+" AND (OptionCode = 'LG1' ) ORDER BY OptionCode DESC");a.isValidRow();)t=a.fieldByName("GraphicFileName"),a.next();var n=Ti.UI.createScrollView({width:"140",height:"35",top:"160",right:"20",borderRadius:"0",contentWidth:Ti.UI.FILL,contentHeight:Ti.UI.FILL,scrollingEnabled:!1}),r=Titanium.UI.createImageView({image:"http://www.venuefinder.com/adverts/"+t,defaultImage:"/images/icon.png",width:"auto",height:Ti.UI.FILL,left:0,top:0});return n.add(r),i.close(),n}function descText(e){for(var t,i=createDatabase("/venuefinder.db","venuefinder"),a=i.execute('SELECT DescriptionText FROM VenueTextForWeb WHERE VenueID="'+e.VenueID+'"');a.isValidRow();)t=a.fieldByName("DescriptionText"),a.next();(null==t||""==t)&&(t="No description could be retrieved for this venue."),t.replace("/<(?:.|\n)*?>/gm","");var n=Titanium.UI.createWebView({html:'<span style="font-family:Arial; color:#000; font-size:14px; line-height:20pts; font-size:15px;">'+t+"</span>",width:"185",height:"270",bottom:"15",left:"42"});return n}function createTitleLocation(e){var t=Titanium.UI.createLabel({text:e.VenueName,ellipsize:!0,color:"#000000",width:"240",height:"24",top:"215",left:"45",font:{fontSize:"24"}}),i=Titanium.UI.createLabel({text:e.Town+", "+e.Country,ellipsize:!0,color:"#000000",width:"240",height:"20",top:"249",left:"45",font:{fontSize:"20",fontFamily:Ti.App.Properties.getString("fontFamily")}});return[t,i]}function createVenueDetail(e){var t=Ti.UI.createView({width:"205",height:"270",bottom:"15",right:"20"}),i=Titanium.UI.createLabel({width:"172",height:"23",top:"0",left:"0",backgroundColor:"transparent",text:"Venue Details",font:{fontSize:"24",fontFamily:Ti.App.Properties.getString("fontFamily")}});t.add(i);var a="<div>"+e.AddressLine1+"</div><div>"+e.Town+", "+e.Country+",</div><div>"+e.Postcode+"</div><div>Tel: "+e.Tel+"</div>",n=Ti.UI.createWebView({html:'<div style="text-align:left;font-family:'+Ti.App.Properties.getString("fontFamily")+'; color:#000; line-height:18pts; font-size:14px;">'+a+"</div>",top:"33",left:"0",width:"200",height:"100",disableBounce:!0});t.add(n);var r="Visit website",o=Titanium.UI.iOS.createAttributedString({text:r});o.addAttribute({type:Titanium.UI.iOS.ATTRIBUTE_UNDERLINES_STYLE,value:Titanium.UI.iOS.ATTRIBUTE_UNDERLINE_STYLE_SINGLE,range:[0,r.length]});var s=Titanium.UI.createLabel({color:"#2195be",font:{fontSize:"14",fontFamily:Ti.App.Properties.getString("fontFamily")},left:"0",top:"143",height:"15",attributedString:o});t.add(s),s.addEventListener("click",function(){var t=Titanium.UI.createWindow({backgroundColor:"rgba(0,0,0,0.8)"}),i=Titanium.UI.createButton({right:"5%",top:"5%",height:"20",zIndex:1,title:"X",color:"#FFF",font:{fontSize:"28",fontWeight:"bold"}});t.add(i),i.addEventListener("click",function(){t.close()});var a=Ti.UI.createView({width:"80%",height:"80%",top:"10%",left:"10%"}),n=Titanium.UI.createWebView({url:e.URL});a.add(n),t.add(a),t.open()});var l="Email this venue",d=Titanium.UI.iOS.createAttributedString({text:l});d.addAttribute({type:Titanium.UI.iOS.ATTRIBUTE_UNDERLINES_STYLE,value:Titanium.UI.iOS.ATTRIBUTE_UNDERLINE_STYLE_SINGLE,range:[0,l.length]});var u=Titanium.UI.createLabel({text:l,color:"#2195be",font:{fontSize:"14",fontFamily:Ti.App.Properties.getString("fontFamily")},left:"0",top:"168",height:"15",attributedString:d});t.add(u),u.addEventListener("click",function(){var t=require("/builders/createEmailer"),i=t(null,e.Email,null,null,e.VenueName,null,null,null,null),a=Titanium.UI.createWindow({backgroundColor:"rgba(0,0,0,0.8)"}),n=Titanium.UI.createButton({right:"5%",top:"5%",height:"20",zIndex:1,title:"X",color:"#FFF",font:{fontSize:"28",fontWeight:"bold"}});a.add(n),n.addEventListener("click",function(){a.close()});var r=Ti.UI.createView({width:"80%",height:"80%",top:"10%",left:"10%"});r.add(i),a.add(r),a.open()});var c="<div style='width:190px'>Max catering capacity<span style='float:right;font-weight:bold'>"+e.MaxCateringCapacity+"</span></div>";c+="<div style='width:190px'>Max meeting capacity<span style='float:right;font-weight:bold'>"+e.MaxMeetingCapacity+"</span></div>",c+="<div style='width:190px'>Number of meeting rooms<span style='float:right;font-weight:bold'>"+e.MeetingRoomsNo+"</span></div>",c+="<div style='width:190px'>Number of bedrooms<span style='float:right;font-weight:bold'>"+e.BedroomsNo+"</span></div>";var f=Ti.UI.createWebView({html:'<div style="left:0px;text-align:left;font-family:'+Ti.App.Properties.getString("fontFamily")+'; color:#000; font-size:12px; line-height:20pts;">'+c+"</div>",top:"193",left:"0",width:"200",height:"78",disableBounce:!0});return t.add(f),t}var createImageGallery=require("views/collview/ImageGallery/createImageGallery"),createHeaderElements=require("/views/collview/listingElements/createHeaderElementsios"),createDatabase=require("/builders/databaseFunctions/createDatabase"),dbUtil=require("/builders/databaseFunctions/dbUtil");module.exports.createDetailPage=createDetailPage;