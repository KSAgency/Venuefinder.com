function createDetailPage(e,t,i){var a=dbUtil.getVenueForId(e),n=createGold1(a,t,i);n.setTop(0),n.setLeft(0);var r=createGold2(a,t,i);r.setTop(0),r.setLeft(0);var o=Ti.UI.createScrollableView({width:"938",height:"720",top:20,layout:"horizontal",showPagingControl:!0,pagingControlColor:"transparent",views:[n,r]});return o}function createGold1(e){var t=Ti.App.Properties.getString("styleName"),i=require("/views/collview/getVenueThumbView"),a=i.setWindowPageStyle(t,!0),n=a[0],r=e.Town;"London"==e.Town&&(r=r+"  "+e.Postcode);var o=Ti.UI.createLabel({color:"#000000",top:"6",right:"18",font:{fontSize:"14",fontFamily:Ti.App.Properties.getString("fontFamily")},text:r,width:"300",height:"35",textAlign:Titanium.UI.TEXT_ALIGNMENT_RIGHT});n.add(o),n.add(createGallery(e.VenueID));var l=Titanium.UI.createLabel({text:e.VenueName,ellipsize:!0,color:"#000000",width:"420",height:"24",top:"465",left:"66",font:{fontSize:"28"}});n.add(l);var s=Titanium.UI.createLabel({text:e.Town+", "+e.Country,ellipsize:!0,color:"#000000",width:"370",height:"24",top:"501",left:"66",font:{fontSize:"24",fontFamily:Ti.App.Properties.getString("fontFamily")}});n.add(s);for(var d,u=createDatabase("/venuefinder.db","venuefinder"),c=u.execute("SELECT * FROM VenueAdvertOptionsForWeb WHERE VenueID="+e.VenueID+" AND (OptionCode = 'LG1' ) ORDER BY OptionCode DESC");c.isValidRow();)d=c.fieldByName("GraphicFileName"),c.next();u.close();var f=Ti.UI.createScrollView({width:"372",height:"54",top:"577",left:"64",borderRadius:"0",contentWidth:Ti.UI.FILL,contentHeight:Ti.UI.FILL,scrollingEnabled:!1}),p=Titanium.UI.createImageView({image:"http://www.venuefinder.com/adverts/"+d,defaultImage:"/images/icon.png",width:"auto",height:Ti.UI.FILL,left:0,top:0});return f.add(p),n.add(f),createGoldSide2(n,e.VenueID),n.add(createGoldSide2(n,e.VenueID)),n}function createGold2(e,t,i){var a=Ti.App.Properties.getString("styleName"),n=require("/views/collview/getVenueThumbView"),r=n.setWindowPageStyle(a,!0),o=r[0],l=e.Town;"London"==e.Town&&(l=l+"  "+e.Postcode);var s=Ti.UI.createLabel({color:"#000000",top:"6",right:"18",font:{fontSize:"14",fontFamily:Ti.App.Properties.getString("fontFamily")},text:l,width:"300",height:"35",textAlign:Titanium.UI.TEXT_ALIGNMENT_RIGHT});o.add(s);var d=Titanium.UI.createLabel({text:e.VenueName,ellipsize:!0,color:"#000000",width:"420",height:"24",top:"70",left:"66",font:{fontSize:"28"}});o.add(d);var u=Titanium.UI.createLabel({text:e.Town+", "+e.Country,ellipsize:!0,color:"#000000",width:"370",height:"24",top:"106",left:"66",font:{fontSize:"24",fontFamily:Ti.App.Properties.getString("fontFamily")}});o.add(u),o.add(createCateringArea(e.VenueID)),o.add(createHeaderElements.createFeaturedButtons(e.VenueID,o,i)),o.add(createVenueDetailSide3(e)),o.add(createVirtualTour(e)),o.add(nearByAttraction(e)),o.add(seeMoreInfoButton()),o.add(createVenueDetailSide4(e));var c=videoArea(e);return null!=c&&o.add(c),db.close(),o}function createCateringArea(e){var t=Ti.UI.createView({width:"232",height:"450",top:"165",left:"0",backgroundColor:"#dededc"}),i=Titanium.UI.createLabel({width:"172",height:"23",top:"19",left:"39",backgroundColor:"transparent",text:"Catering",font:{fontSize:"24",fontFamily:Ti.App.Properties.getString("fontFamily")}});t.add(i);for(var a=createDatabase("/venuefinder.db","venuefinder"),n=a.execute("SELECT * FROM VenueAdvertOptionsForWeb WHERE VenueID='"+e+"' AND (OptionCode='MIL' OR OptionCode = 'PIC' ) ORDER BY OrderKey, GraphicFileName DESC");n.isValidRow();){logoUrl=n.fieldByName("GraphicFileName");break}var r=Ti.UI.createScrollView({width:"171",height:"121",top:"48",left:"39",borderRadius:"0",contentWidth:Ti.UI.FILL,contentHeight:Ti.UI.FILL,scrollingEnabled:!1,backgroundColor:"transparent"}),o=Titanium.UI.createImageView({image:"http://www.venuefinder.com/adverts/"+logoUrl,defaultImage:"/images/icon.png",width:"auto",height:Ti.UI.FILL,left:0,top:0});r.add(o),t.add(r);for(var l,s=(Titanium.UI.createLabel({width:"172",height:"25",top:"181",left:"39",backgroundColor:"transparent",text:"Lorem ipsum dolor sit amet",font:{fontSize:"14",fontFamily:Ti.App.Properties.getString("fontFamily")}}),a.execute('SELECT DescriptionText FROM VenueTextForWeb WHERE VenueID="'+e+'"'));s.isValidRow();)l=s.fieldByName("DescriptionText"),s.next();(null==l||""==l)&&(l="No description could be retrieved for this venue."),l.replace("/<(?:.|\n)*?>/gm","");var d=Titanium.UI.createWebView({html:'<span style="font-family:'+Ti.App.Properties.getString("fontFamily")+'; color:#000; font-size:14px; line-height:20pts; font-size:15px;">'+l+"</span>",top:"0",width:"100%",left:"0",backgroundColor:"transparent",disableBounce:!0}),u=Titanium.UI.createScrollView({contentWidth:"176",contentHeight:"auto",showVerticalScrollIndicator:!0,showHorizontalScrollIndicator:!1,width:"172",height:"197",top:"214",right:"170",left:"35",font:{fontFamily:Ti.App.Properties.getString("fontFamily"),fontSize:"14"},backgroundColor:"transparent"});return u.add(d),t.add(u),a.close(),t}function createVenueDetailSide3(e){var t=Ti.UI.createView({width:"232",height:"450",top:"165",left:"232"}),i=Titanium.UI.createLabel({width:"172",height:"23",top:"19",left:"32",backgroundColor:"transparent",text:"Venue Details",font:{fontSize:"24",fontFamily:Ti.App.Properties.getString("fontFamily")}});t.add(i);var a="<div>"+e.AddressLine1+"</div><div>"+e.Town+", "+e.Country+",</div><div>"+e.Postcode+"</div><div>Tel: "+e.Tel+"</div>",n=Ti.UI.createWebView({html:'<div style="text-align:left;font-family:'+Ti.App.Properties.getString("fontFamily")+'; color:#000; line-height:18pts; font-size:14px;">'+a+"</div>",top:"52",left:"26",width:"200",height:"100",disableBounce:!0});t.add(n);var r="Visit website",o=Titanium.UI.iOS.createAttributedString({text:r});o.addAttribute({type:Titanium.UI.iOS.ATTRIBUTE_UNDERLINES_STYLE,value:Titanium.UI.iOS.ATTRIBUTE_UNDERLINE_STYLE_SINGLE,range:[0,r.length]});var l=Titanium.UI.createLabel({color:"#2195be",font:{fontSize:"14",fontFamily:Ti.App.Properties.getString("fontFamily")},left:"32",top:"162",height:"18",attributedString:o});t.add(l),l.addEventListener("click",function(){var t=Titanium.UI.createWindow({backgroundColor:"rgba(0,0,0,0.8)"}),i=Titanium.UI.createButton({right:"5%",top:"5%",height:"20",zIndex:1,title:"X",color:"#FFF",font:{fontSize:"28",fontWeight:"bold"}});t.add(i),i.addEventListener("click",function(){t.close()});var a=Ti.UI.createView({width:"80%",height:"80%",top:"10%",left:"10%"}),n=Titanium.UI.createWebView({url:e.URL});a.add(n),t.add(a),t.open()});var s="Email this venue",d=Titanium.UI.iOS.createAttributedString({text:s});d.addAttribute({type:Titanium.UI.iOS.ATTRIBUTE_UNDERLINES_STYLE,value:Titanium.UI.iOS.ATTRIBUTE_UNDERLINE_STYLE_SINGLE,range:[0,s.length]});var u=Titanium.UI.createLabel({text:s,color:"#2195be",font:{fontSize:"14",fontFamily:Ti.App.Properties.getString("fontFamily")},left:"32",top:"180",height:"18",attributedString:d});t.add(u),u.addEventListener("click",function(){var t=require("/builders/createEmailer"),i=t(null,e.Email,null,null,e.VenueName,null,null,null,null),a=Titanium.UI.createWindow({backgroundColor:"rgba(0,0,0,0.8)"}),n=Titanium.UI.createButton({right:"5%",top:"5%",height:"20",zIndex:1,title:"X",color:"#FFF",font:{fontSize:"28",fontWeight:"bold"}});a.add(n),n.addEventListener("click",function(){a.close()});var r=Ti.UI.createView({width:"80%",height:"80%",top:"10%",left:"10%"});r.add(i),a.add(r),a.open()});var c="<div style='width:195px'>Max catering capacity<span style='float:right;font-weight:bold'>"+e.MaxCateringCapacity+"</span></div>";c+="<div style='width:195px'>Max meeting capacity<span style='float:right;font-weight:bold'>"+e.MaxMeetingCapacity+"</span></div>",c+="<div style='width:195px'>Number of meeting rooms<span style='float:right;font-weight:bold'>"+e.MeetingRoomsNo+"</span></div>",c+="<div style='width:195px'>Number of bedrooms<span style='float:right;font-weight:bold'>"+e.BedroomsNo+"</span></div>";var f=Ti.UI.createWebView({html:'<div style="left:0px;text-align:left;font-family:'+Ti.App.Properties.getString("fontFamily")+'; color:#000; font-size:13px; line-height:22pts;">'+c+"</div>",top:"208",left:"25",width:"210",height:"100",disableBounce:!0});return t.add(f),t}function createVirtualTour(e){var t=Ti.UI.createView({width:"175",height:"130",top:"483",left:"256"}),i=Titanium.UI.createLabel({width:"175",height:"20",top:"0",left:"7",text:"Virtual Tours",font:{fontSize:"24",fontFamily:Ti.App.Properties.getString("fontFamily")}});t.add(i);for(var a,n=createDatabase("/venuefinder.db","venuefinder"),r=n.execute("SELECT * FROM VenueAdvertOptionsForWeb WHERE VenueID='"+e.VenueID+"' AND (OptionCode='MIL' OR OptionCode = 'PIC' ) ORDER BY OrderKey, GraphicFileName DESC"),o=r.rowCount,l=0;r.isValidRow();){if(l++,o>1){if(2==l){a=r.fieldByName("GraphicFileName");break}}else a=r.fieldByName("GraphicFileName");r.next()}n.close();var s=Ti.UI.createScrollView({width:"178",height:"105",top:"38",left:"0",borderRadius:"0",contentWidth:Ti.UI.FILL,contentHeight:Ti.UI.FILL,scrollingEnabled:!1,backgroundColor:"transparent"}),d=Titanium.UI.createImageView({image:"http://www.venuefinder.com/adverts/"+a,defaultImage:"/images/icon.png",width:"auto",height:Ti.UI.FILL,left:"1",top:0});return s.add(d),t.add(s),t}function videoArea(e){for(var t,i=require("/builders/databaseFunctions/createDatabase"),a=i("/venuefinder.db","venuefinder"),n=a.execute("SELECT * FROM VenueAdvertOptionsForWeb WHERE VenueID="+e.VenueID+" AND OptionCode='VID' AND URL IS NOT NULL ORDER BY OrderKey ASC");n.isValidRow();){var t=n.fieldByName("URL"),r=n.fieldByName("GraphicFileName");break}if(a.close(),null!=t){var o=Ti.UI.createView({width:"248",height:"193",top:"330",left:"512"}),l=Titanium.UI.createLabel({width:"175",height:"20",top:"0",left:"7",text:"Video",font:{fontSize:"24",fontFamily:Ti.App.Properties.getString("fontFamily")}});o.add(l);var s=Titanium.UI.createImageView({image:"http://www.venuefinder.com/adverts/"+r,defaultImage:"/images/icon.png",width:"auto",height:164,top:"29",left:"0"});return o.add(s),s.addEventListener("click",function(){var e=Titanium.UI.createWindow({backgroundColor:"rgba(0,0,0,0.8)"}),i=Titanium.UI.createButton({right:"5%",top:"5%",height:"20",zIndex:1,title:"X",color:"#FFF",font:{fontSize:"28",fontWeight:"bold"}});e.add(i),i.addEventListener("click",function(){e.close()});var a=(Ti.UI.createView({width:"80%",height:"80%",top:"10%",left:"10%"}),Titanium.UI.createWebView({url:t,width:"80%",height:"80%",top:"10%",left:"10%"}));e.add(a),e.open()}),o}return null}function nearByAttraction(e){var t=Ti.UI.createView({width:"120",height:"197",top:"324",left:"786"}),i=Titanium.UI.createLabel({width:"120",height:"65",top:"0",left:"0",text:"Nearby Attractions",font:{fontSize:"24",fontFamily:Ti.App.Properties.getString("fontFamily")}});t.add(i);var a=Ti.UI.createScrollView({top:"58",left:"0",width:"120",height:"139",disableBounce:!0,contentHeight:"auto",contentWidth:"110",layout:"vertical",showVerticalScrollIndicator:!0}),n=!0,r=!0;if(Ti.Network.online){{var o=require("/builders/databaseFunctions/createDatabase"),l=o("/venuefinder.db","venuefinder"),s=l.execute('SELECT * FROM Venue WHERE VenueID="'+e.VenueID+'"'),d=(s.fieldByName("VenueName"),s.fieldByName("Town"));s.fieldByName("Country")}if(""!=d&&null!=d)var d=d+", ";else var d="";if(""!=u&&null!=u)var u=u+", ";else var u="";var c=Ti.Network.createHTTPClient();c.open("GET","http://venuefindermobile.live.x-rm.com/webapi-v1/api/venue/"+e.VenueID+"/leisurefacilities"),c.setRequestHeader("Accept","application/xml"),c.onload=function(){try{var e=this.responseXML.documentElement,t=e.getElementsByTagName("LeisureFacility");if(0==t.length)n=!1;else{var i=Titanium.UI.createLabel({text:"Leisure Facilities",color:"#2195be",font:{fontSize:"14",fontFamily:Ti.App.Properties.getString("fontFamily"),fontWeight:"bold"},top:"10",left:"0"});a.add(i);for(var r=0;r<t.length;r++){var o=t.item(r),l=o.getElementsByTagName("Description").item(0).text,s=(o.getElementsByTagName("ID").item(0).text,o.getElementsByTagName("Nearby").item(0).text,o.getElementsByTagName("OnSite").item(0).text,Titanium.UI.createLabel({text:l,color:"#666",font:{fontSize:"12",fontFamily:Ti.App.Properties.getString("fontFamily")},left:"0"}));a.add(s)}}}catch(d){alert(d)}},c.send();var f=Ti.Network.createHTTPClient();f.open("GET","http://venuefindermobile.live.x-rm.com/webapi-v1/api/venue/"+e.venueID+"/hotelfacilities"),f.setRequestHeader("Accept","application/xml"),f.onload=function(){try{var e=this.responseXML.documentElement,t=e.getElementsByTagName("HotelFacility");if(0==t.length)r=!1;else{var i=Titanium.UI.createLabel({text:"Venue Facilities",color:"#2195be",font:{fontSize:"14",fontFamily:"Arial",fontWeight:"bold"},left:"0",top:"10pts"});a.add(i);for(var o=0;o<t.length;o++){var l=t.item(o),s=l.getElementsByTagName("Name").item(0).text,d=Titanium.UI.createLabel({text:s,color:"#666",font:{fontSize:"12",fontFamily:Ti.App.Properties.getString("fontFamily")},left:"0"});a.add(d)}}if(0==r&&0==n){var u=Titanium.UI.createLabel({text:"Sorry, we could not find any facilities information for this venue",color:"#666",font:{fontSize:"12",fontFamily:Ti.App.Properties.getString("fontFamily")},left:"0"});a.add(u)}}catch(c){alert(c)}},f.send()}return t.add(a),t}function seeMoreInfoButton(){var e=Ti.UI.createButton({width:"391",height:"61",right:"38",bottom:"45",title:"See more information on venuefinder.com",backgroundColor:"#399ad4",color:"#FFFFFF",font:{fontSize:"18"}});return e.addEventListener("click",function(){var e=Titanium.UI.createWindow({backgroundColor:"rgba(0,0,0,0.8)"}),t=Titanium.UI.createButton({right:"5%",top:"5%",height:"20",zIndex:1,title:"X",color:"#FFF",font:{fontSize:"28",fontWeight:"bold"}});e.add(t),t.addEventListener("click",function(){e.close()});var i=Ti.UI.createView({width:"80%",height:"80%",top:"10%",left:"10%"}),a=Titanium.UI.createWebView({url:"http://www.venuefinder.com"});i.add(a),e.add(i),e.open()}),e}function createVenueDetailSide4(e){var t=Ti.UI.createView({width:"245",height:"252",top:"53",left:"511",backgroundColor:"#dededc"}),i=Titanium.UI.createLabel({width:"245",height:"18",top:"17",left:"14",backgroundColor:"transparent",text:"Venue Details",font:{fontSize:"24",fontFamily:Ti.App.Properties.getString("fontFamily")}});t.add(i);for(var a,n=createDatabase("/venuefinder.db","venuefinder"),r=n.execute("SELECT * FROM VenueAdvertOptionsForWeb WHERE VenueID='"+e.VenueID+"' AND (OptionCode='MIL' OR OptionCode = 'PIC' ) ORDER BY OrderKey, GraphicFileName DESC"),o=0;r.isValidRow();){if(o++,o>2){a=r.fieldByName("GraphicFileName");break}r.next()}n.close();var l=Ti.UI.createScrollView({width:"216",height:"158",top:"48",left:"14",borderRadius:"0",contentWidth:Ti.UI.FILL,contentHeight:Ti.UI.FILL,scrollingEnabled:!1,backgroundColor:"transparent"}),s=Titanium.UI.createImageView({image:"http://www.venuefinder.com/adverts/"+a,defaultImage:"/images/icon.png",width:"auto",height:Ti.UI.FILL,left:0,top:0});l.add(s),t.add(l);var d=Titanium.UI.createLabel({width:"217",height:"52",top:"200",left:"14",backgroundColor:"transparent",text:"Lorem ipsum dolor sit amet",font:{fontSize:"14",fontFamily:Ti.App.Properties.getString("fontFamily")}});return t.add(d),t}function createGallery(e){for(var t=require("/builders/databaseFunctions/createDatabase"),i=t("/venuefinder.db","venuefinder"),a=i.execute("SELECT * FROM VenueAdvertOptionsForWeb WHERE VenueID="+e+" AND (OptionCode = 'TOP' OR OptionCode = 'PIC') ORDER BY OptionCode, OrderKey, GraphicFileName DESC"),n=[],r=Ti.UI.createView({width:406,height:348,left:30,top:52}),o=0;a.isValidRow();){var l=(a.fieldByName("OptionCode"),a.fieldByName("GraphicFileName"));if(0==o){var s=Ti.UI.createScrollView({width:"266",height:"230",top:"0",left:"0",borderRadius:"0",contentWidth:Ti.UI.FILL,contentHeight:Ti.UI.FILL,scrollingEnabled:!1}),d=Titanium.UI.createImageView({image:"http://www.venuefinder.com/adverts/"+l,defaultImage:"/images/icon.png",index:o,width:Ti.UI.FILL,height:Ti.UI.FILL,left:0,top:0});d.addEventListener("click",function(e){createImageGallery(null,n,e.source.index)}),s.add(d),r.add(s)}else{var u=10,c=10;1==o?(u=0,c=278):2==o?(u=122,c=278):3==o?(u=242,c=0):4==o?(u=242,c=140):5==o&&(u=242,c=280);var s=Ti.UI.createScrollView({width:"128",height:"106",top:u,left:c,borderRadius:"0",contentWidth:Ti.UI.FILL,contentHeight:Ti.UI.FILL,scrollingEnabled:!1}),f=Titanium.UI.createImageView({image:"http://www.venuefinder.com/adverts/"+l,defaultImage:"/images/icon.png",index:o,width:Ti.UI.FILL,height:Ti.UI.FILL,left:0,top:0});f.addEventListener("click",function(e){createImageGallery(null,n,e.source.index)}),s.add(f),r.add(s)}if(o++,n.push("http://www.venuefinder.com/adverts/"+l),a.next(),6==o)break}return i.close(),r}function createGoldSide2(e,t){for(var i=require("/builders/databaseFunctions/createDatabase"),a=i("/venuefinder.db","venuefinder"),n=a.execute("SELECT * FROM VenueAdvertOptionsForWeb WHERE VenueID='"+t+"' AND (OptionCode='MIL' OR OptionCode = 'PIC' ) ORDER BY OrderKey, GraphicFileName ASC"),r=[],o=0,l=Ti.UI.createView({width:270,height:348,right:170,top:52,layout:"horizontal"});n.isValidRow();){{var s,d,u,c,f=n.fieldByName("OptionCode"),p=n.fieldByName("GraphicFileName");n.fieldByName("URL")}if("MIL"==f||"PIC"==f){0==o?(s=128,d=106,c=0,u=0):1==o?(s=128,d=106,c=14,u=0):2==o&&(s=270,d=230,c=0,u=17);var g=Ti.UI.createScrollView({width:s,height:d,top:u,left:c,borderRadius:"0",contentWidth:Ti.UI.FILL,contentHeight:Ti.UI.FILL,scrollingEnabled:!1}),m=Titanium.UI.createImageView({image:"http://www.venuefinder.com/adverts/"+p,defaultImage:"/images/icon.png",index:o,width:Ti.UI.FILL,height:Ti.UI.FILL,left:0,top:0});g.add(m),l.add(g),r.push(m.image),m.addEventListener("click",function(e){createImageGallery(null,r,e.source.index)}),o++}n.next()}for(var h,v=a.execute('SELECT DescriptionText FROM VenueTextForWeb WHERE VenueID="'+t+'"');v.isValidRow();)h=v.fieldByName("DescriptionText"),v.next();(null==h||""==h)&&(h="No description could be retrieved for this venue."),h.replace("/<(?:.|\n)*?>/gm","");var b=Titanium.UI.createWebView({html:'<span style="font-family:Arial; color:#000; font-size:14px; line-height:20pts; font-size:15px;">'+h+"</span>",width:"270",height:"180",bottom:"31",right:"170"});e.add(b),e.add(createHeaderElements.createFeaturedButtons(t,e,windowsArray));var T=createHeaderElements.createSpeOfferBtn(t);return null!=T&&e.add(T),a.close(),l}var createImageGallery=require("views/collview/ImageGallery/createImageGallery"),createHeaderElements=require("/views/collview/listingElements/createHeaderElementsios"),createDatabase=require("/builders/databaseFunctions/createDatabase"),dbUtil=require("/builders/databaseFunctions/dbUtil");module.exports.createDetailPage=createDetailPage;