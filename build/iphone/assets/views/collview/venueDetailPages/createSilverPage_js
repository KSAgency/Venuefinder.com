function createDetailPage(e,t,i,a){var n;i[2]&&(i=i[2],n="map");for(var r,o,l=dbUtil.getVenueForId(e),s=0;s<t.length;s++)e==t[s].venueID&&(r=t[s+1]?t[s+1].venueID:"0",o=t[s-1]?t[s-1].venueID:"0");var d=createViewBackground(l);d.add(createGallery(l));var u=createTitleLocation(l);d.add(u[0]);var c=logoAndDescText(l,u[1]);d.add(c[0]),d.add(c[1]),d.add(side2Gallery(l)),d.add(createHeaderElements.createFeaturedButtons(l.VenueID,d)),d.add(createVenueDetail(l));var f=createSilverSpeOfferBtn(l);null!=f&&d.add(f),d.add(seeMoreInfoButton());var g=Ti.UI.createImageView({image:"/images/pageTurnButton",width:"34",right:"0"});"0"!=r&&"map"!=n&&i.add(g);var p=Ti.UI.createImageView({image:"/images/pageTurnButton",width:"34",left:"0",transform:Ti.UI.create2DMatrix({rotate:180})});return"0"!=o&&"map"!=n&&i.add(p),g.addEventListener("click",function(){var e=dbUtil.getVenueForId(r).PackageCode;if("GLD"==e){i.remove(d),i.remove(g),i.remove(p),d.parent.remove(d);var n=require("/views/collview/venueDetailPages/createGoldPage"),l=n.createDetailPage(r,t,i,a);i.add(l)}else if("SIL"==e){i.remove(d),i.remove(g),i.remove(p),d.parent.remove(d);var n=require("/views/collview/venueDetailPages/createSilverPage"),s=n.createDetailPage(r,t,i,a);i.add(s)}else if("PRE"==e){i.remove(d),i.remove(g),i.remove(p),d.parent.remove(d);var n=require("/views/collview/venueDetailPages/createBronzePage"),u=n.createDetailPage(r,r,o,i,a);i.add(u)}}),p.addEventListener("click",function(){var e=dbUtil.getVenueForId(o).PackageCode;if("GLD"==e){i.remove(d),i.remove(g),i.remove(p);var n=require("/views/collview/venueDetailPages/createGoldPage"),r=n.createDetailPage(o,t,i,a);i.add(r)}else if("SIL"==e){i.remove(d),i.remove(g),i.remove(p);var n=require("/views/collview/venueDetailPages/createSilverPage"),l=n.createDetailPage(o,t,i,a);i.add(l)}else if("PRE"==e){i.remove(d),i.remove(g),i.remove(p);var n=require("/views/collview/venueDetailPages/createBronzePage"),s=n.createDetailPage(o,t,i,a);i.add(s)}}),d}function createViewBackground(e){var t=Ti.App.Properties.getString("styleName"),i=require("/views/collview/getVenueThumbView"),a=i.setWindowPageStyle(t,!0),n=a[0],r=e.Town;"London"==e.Town&&(r=r+"  "+e.Postcode);var o=Ti.UI.createLabel({color:"#000000",top:"6",right:"18",font:{fontSize:"14",fontFamily:Ti.App.Properties.getString("fontFamily")},text:r,width:"300",height:"35",textAlign:Titanium.UI.TEXT_ALIGNMENT_RIGHT});return n.add(o),n}function createGallery(e){for(var t=require("/builders/databaseFunctions/createDatabase"),i=t("/venuefinder.db","venuefinder"),a=i.execute("SELECT * FROM VenueAdvertOptionsForWeb WHERE VenueID="+e.VenueID+" AND (OptionCode='TOP' OR OptionCode = 'PIC' OR OptionCode='MID' OR OptionCode='MIL' OR OptionCode='MIR') ORDER BY OptionCode ASC LIMIT 3"),n=[],r=Ti.UI.createView({width:410,height:214,left:36,top:70}),o=0;a.isValidRow();){var l=(a.fieldByName("OptionCode"),a.fieldByName("GraphicFileName"));if(0==o){var s=Ti.UI.createScrollView({width:"265",height:"214",top:"0",left:"0",borderRadius:"0",contentWidth:Ti.UI.FILL,contentHeight:Ti.UI.FILL,scrollingEnabled:!1}),d=Titanium.UI.createImageView({image:"http://www.venuefinder.com/adverts/"+l,defaultImage:"/images/icon.png",index:o,width:Ti.UI.FILL,height:Ti.UI.FILL,left:0,top:0});s.add(d),r.add(s)}else{var u=10,c=15;1==o?(u=0,c=280):2==o&&(u=116,c=280);var s=Ti.UI.createScrollView({width:"130",height:"102",top:u,left:c,borderRadius:"0",contentWidth:Ti.UI.FILL,contentHeight:Ti.UI.FILL,scrollingEnabled:!1}),f=Titanium.UI.createImageView({image:"http://www.venuefinder.com/adverts/"+l,defaultImage:"/images/icon.png",index:o,width:Ti.UI.FILL,height:Ti.UI.FILL,left:0,top:0});s.add(f),r.add(s)}if(o++,n.push("http://www.venuefinder.com/adverts/"+l),a.next(),3==o)break}return i.close(),r}function createTitleLocation(e){var t=Ti.UI.createView({top:"326",left:"98",width:Ti.UI.SIZE,height:Ti.UI.SIZE,layout:"vertical"}),i=Titanium.UI.createLabel({text:e.VenueName,ellipsize:!0,color:"#000000",top:0,width:360,left:0,height:Ti.UI.SIZE,font:{fontSize:"28"}}),a=Titanium.UI.createLabel({text:e.Town+", "+e.Country,ellipsize:!0,color:"#000000",width:"380",top:"0",left:0,font:{fontSize:"24",fontFamily:Ti.App.Properties.getString("fontFamily")}});t.add(i),t.add(a);var n=t.toImage().height+parseInt(t.getTop())+20;return[t,n]}function logoAndDescText(e,t){for(var i,a=createDatabase("/venuefinder.db","venuefinder"),n=a.execute('SELECT DescriptionText FROM VenueTextForWeb WHERE VenueID="'+e.VenueID+'"');n.isValidRow();)i=n.fieldByName("DescriptionText"),n.next();(null==i||""==i)&&(i="No description could be retrieved for this venue."),i.replace("/<(?:.|\n)*?>/gm","");for(var r=Titanium.UI.createWebView({html:'<span style="font-family:Arial; color:#000; font-size:14px; line-height:20pts; font-size:15px;">'+i+"</span>",width:"225",height:Ti.UI.FILL,top:t,left:"240",bottom:20}),a=createDatabase("/venuefinder.db","venuefinder"),o=a.execute("SELECT * FROM VenueAdvertOptionsForWeb WHERE VenueID="+e.VenueID+" AND (OptionCode='LG1' OR OptionCode = 'GR1' OR OptionCode='AS1') ORDER BY OptionCode DESC"),l=Ti.UI.createView({width:Ti.UI.SIZE,height:Ti.UI.SIZE,bottom:"50",left:"30",borderRadius:"0",layout:"horizontal"});o.isValidRow();){var s=Titanium.UI.createImageView({image:"http://www.venuefinder.com/adverts/"+o.fieldByName("GraphicFileName"),defaultImage:"/images/icon.png",width:125});o.rowCount>1&&(s.setWidth((s.width-s.width/3).toString()),s.setLeft(10)),l.add(s),o.next()}return a.close(),[l,r]}function side2Gallery(e){for(var t=createDatabase("/venuefinder.db","venuefinder"),i=t.execute("SELECT * FROM VenueAdvertOptionsForWeb WHERE VenueID='"+e.VenueID+"' AND (OptionCode='TOP' OR OptionCode = 'PIC' OR OptionCode='MID' OR OptionCode='MIL' OR OptionCode='MIR') ORDER BY OptionCode ASC LIMIT 4 OFFSET 3"),a=0,n=[],r=0,o=Ti.UI.createView({width:265,height:214,left:506,top:70,layout:"horizontal"});i.isValidRow();){{var l,s,d,u,c=i.fieldByName("OptionCode"),f=i.fieldByName("GraphicFileName");i.fieldByName("URL")}if(l=130,s=102,"MIL"==c||"PIC"==c){if("PIC"==c&&(a++,3>a))continue;0==r?(u=0,d=0):1==r?(u=5,d=0):2==r?(u=0,d=10):3==r&&(u=5,d=10);var g=Ti.UI.createScrollView({width:l,height:s,top:d,left:u,borderRadius:"0",contentWidth:Ti.UI.FILL,contentHeight:Ti.UI.FILL,scrollingEnabled:!1}),p=Titanium.UI.createImageView({image:"http://www.venuefinder.com/adverts/"+f,defaultImage:"/images/icon.png",index:r,width:Ti.UI.FILL,height:Ti.UI.FILL,left:0,top:0});if(g.add(p),o.add(g),n.push(p.image),r++,4==r)break}i.next()}return t.close(),o}function createVenueDetail(e){var t=Ti.UI.createView({width:"230",height:"300",bottom:"20",right:"192"}),i=Titanium.UI.createLabel({width:"172",height:"23",top:"0",left:"32",backgroundColor:"transparent",text:"Venue Details",font:{fontSize:"24",fontFamily:Ti.App.Properties.getString("fontFamily")}});t.add(i);var a;a="England"==e.Country||"Scotland"==e.Country||"Northern Ireland"==e.Country||"Wales"==e.Country?e.Tel:"+44 (0)1780 484498";var n="<div>"+e.AddressLine1+"</div><div>"+e.Town+", "+e.Country+",</div><div>"+e.Postcode+"</div><div>Tel: "+a+"</div>",r=Ti.UI.createWebView({html:'<div style="text-align:left;font-family:'+Ti.App.Properties.getString("fontFamily")+'; color:#000; line-height:18pts; font-size:14px;">'+n+"</div>",top:"33",left:"28",width:"200",height:"100",disableBounce:!0});t.add(r);var o="Email this venue",l=Titanium.UI.iOS.createAttributedString({text:o});l.addAttribute({type:Titanium.UI.iOS.ATTRIBUTE_UNDERLINES_STYLE,value:Titanium.UI.iOS.ATTRIBUTE_UNDERLINE_STYLE_SINGLE,range:[0,o.length]});var s=Titanium.UI.createLabel({text:o,color:"#2195be",font:{fontSize:"14",fontFamily:Ti.App.Properties.getString("fontFamily")},left:"38",top:"143",height:"18",attributedString:l});t.add(s),s.addEventListener("click",function(){var t;t="England"==e.Country||"Scotland"==e.Country||"Northern Ireland"==e.Country||"Wales"==e.Country?e.Email:"VenueFinder@trinityconferences.co.uk";var i=require("/builders/createEmailer"),a=i(null,t,null,null,e.VenueName,null,null,null,null),n=Titanium.UI.createWindow({backgroundColor:"rgba(0,0,0,0.8)"}),r=Titanium.UI.createButton({right:"5%",top:"5%",height:"20",zIndex:1,title:"X",color:"#FFF",font:{fontSize:"28",fontWeight:"bold"}});n.add(r),r.addEventListener("click",function(){n.close()});var o=Ti.UI.createView({width:"80%",height:"80%",top:"10%",left:"10%"});o.add(a),n.add(o),n.open()});var d="Visit website",u=Titanium.UI.iOS.createAttributedString({text:d});u.addAttribute({type:Titanium.UI.iOS.ATTRIBUTE_UNDERLINES_STYLE,value:Titanium.UI.iOS.ATTRIBUTE_UNDERLINE_STYLE_SINGLE,range:[0,d.length]});var c=Titanium.UI.createLabel({color:"#2195be",font:{fontSize:"14",fontFamily:Ti.App.Properties.getString("fontFamily")},left:"38",top:"171",height:"18",attributedString:u});t.add(c),c.addEventListener("click",function(){var t=Titanium.UI.createWindow({backgroundColor:"rgba(0,0,0,0.8)"}),i=Titanium.UI.createButton({right:"5%",top:"5%",height:"20",zIndex:1,title:"X",color:"#FFF",font:{fontSize:"28",fontWeight:"bold"}});t.add(i),i.addEventListener("click",function(){t.close()});var a=Ti.UI.createView({width:"80%",height:"80%",top:"10%",left:"10%"}),n=Titanium.UI.createWebView({url:e.URL});a.add(n),t.add(a),t.open()});var f="<div style='width:195px'>Max catering capacity<span style='float:right;font-weight:bold'>"+e.MaxCateringCapacity+"</span></div>";f+="<div style='width:195px'>Max meeting capacity<span style='float:right;font-weight:bold'>"+e.MaxMeetingCapacity+"</span></div>",f+="<div style='width:195px'>Number of meeting rooms<span style='float:right;font-weight:bold'>"+e.MeetingRoomsNo+"</span></div>",f+="<div style='width:195px'>Number of bedrooms<span style='float:right;font-weight:bold'>"+e.BedroomsNo+"</span></div>";var g=Ti.UI.createWebView({html:'<div style="left:0px;text-align:left;font-family:'+Ti.App.Properties.getString("fontFamily")+'; color:#000; font-size:13px; line-height:22pts;">'+f+"</div>",top:"199",left:"28",width:"230",height:"100",disableBounce:!0});return t.add(g),t}function seeMoreInfoButton(){var e=Ti.UI.createView({width:130,height:64,bottom:20,right:12,backgroundColor:"#FFFFFF"}),t=Ti.UI.createLabel({width:"102",height:"54",left:"14",bottom:"5",backgroundColor:"#399ad4",color:"#FFFFFF",font:{fontSize:"12",fontFamily:Ti.App.Properties.getString("fontFamily")}}),i=Ti.UI.createLabel({width:"86",height:"44",left:"8",text:"See more information on venuefinder.com",bottom:"5",backgroundColor:"tranparent",color:"#FFFFFF",font:{fontSize:"11"}});return i.addEventListener("click",function(){t.fireEvent("click")}),t.add(i),e.add(t),t.addEventListener("click",function(){var e=Titanium.UI.createWindow({backgroundColor:"rgba(0,0,0,0.8)"}),t=Titanium.UI.createButton({right:"5%",top:"5%",height:"20",zIndex:1,title:"X",color:"#FFF",font:{fontSize:"28",fontWeight:"bold"}});e.add(t),t.addEventListener("click",function(){e.close()});var i=Ti.UI.createView({width:"80%",height:"80%",top:"10%",left:"10%"}),a=Titanium.UI.createWebView({url:"http://www.venuefinder.com"});i.add(a),e.add(i),e.open()}),e}function createSilverSpeOfferBtn(e){var t=createDatabase("/venuefinder.db","venuefinder"),i=require("/builders/todaysDate"),a=i(),n=!1,r=t.execute('SELECT * FROM Offers WHERE EntryID="'+e.VenueID+'" AND validToDate>="'+a+'"');0!=r.rowCount&&(n=!0);var o=null;if(n){o=Ti.UI.createView({right:12,bottom:94,width:130,height:50,backgroundColor:"#FFFFFF"});var l=Titanium.UI.createImageView({image:"/images/listing_offers.png",left:12,top:10,width:102,height:"auto"});o.add(l),l.addEventListener("click",function(){var t=Titanium.UI.createScrollView({top:"0%",zIndex:5,layout:"vertical",backgroundColor:"#FFF"}),i=require("/views/children/listingElements/createOffersTab");i(null,null,t,e.VenueID,null);var a=Titanium.UI.createWindow({backgroundColor:"rgba(0,0,0,0.8)"}),n=Ti.UI.createView({width:"60%",height:"60%",top:"10%",left:"20%",layout:"vertical"}),r=Ti.UI.createView({top:0,left:0,height:"15%",width:Ti.UI.FILL,backgroundColor:"#e6a723"}),o=Titanium.UI.createLabel({text:"Special Offers",left:"15",width:"85%",height:"40",top:"15",ellipsize:!0,color:"#ffffff",font:{fontSize:"34",fontFamily:Ti.App.Properties.getString("fontFamily")}});r.add(o);var l=Titanium.UI.createButton({right:"15",top:"10",title:"X",color:"#FFF",font:{fontSize:"28",fontWeight:"bold"}});r.add(l),l.addEventListener("click",function(){a.close()}),n.add(r),n.add(t),a.add(n),a.open()})}return t.close(),o}function singleImage(){var e=Ti.UI.createView({width:"130",height:"102",bottom:"154",right:"12",backgroundColor:"#dededc"});return e}var createImageGallery=require("views/collview/ImageGallery/createImageGallery"),createHeaderElements=require("/views/collview/listingElements/createHeaderElementsios"),createDatabase=require("/builders/databaseFunctions/createDatabase"),dbUtil=require("/builders/databaseFunctions/dbUtil");module.exports.createDetailPage=createDetailPage;