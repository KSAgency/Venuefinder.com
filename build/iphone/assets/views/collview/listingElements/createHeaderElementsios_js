function createFeaturedButtons(e,t,i){var a=require("/builders/databaseFunctions/dbUtil"),n=a.getVenueForId(e),r=require("/builders/databaseFunctions/createDatabase"),o=r("/venuefinder.db","venuefinder"),s=o.execute('SELECT * FROM VenueAdvertOptionsForWeb WHERE VenueID="'+e+'" AND OptionCode = "FLR"'),l=Ti.UI.createView({width:136,height:150,layout:"vertical",top:84,right:5});return l.add(createFavBtn(e,t)),l.add(createMapBtn(e,t,i)),l.add(createVenueAdviceBtn()),l.add(createShareBtn(e,t)),"GLD"==n.PackageCode&&0!=s.rowCount&&l.add(createFloorPlansBtn(e)),o.close(),l}function createFavBtn(e,t){function i(){if(m!=e){var i=Titanium.UI.createAlertDialog({message:"Would you like to rate this venue?",buttonNames:["Not Now","Rate"]});i.show(),i.addEventListener("click",function(i){if(0==i.index){{var a=require("/builders/databaseFunctions/createDatabase"),n=a("/favourites.db","favourites");n.execute('INSERT INTO Favourites ("VenueID", "VenueName", "AddressLine1", "AddressLine2", "Town", "County", "Country", "Postcode", "PackageCode") VALUES ("'+e+'", "'+l+'", "'+d+'", "'+u+'", "'+c+'", "'+f+'", "'+p+'", "'+g+'", "'+s+'")')}n.close(),w.setImage("/images/add_favourites_dslctd.png")}else{var r=[];r[0]=Ti.UI.createPickerRow({title:"Please select a rating",value:"0"}),r[1]=Ti.UI.createPickerRow({title:"5 - Excellent",value:"5"}),r[2]=Ti.UI.createPickerRow({title:"4 - Very Good",value:"4"}),r[3]=Ti.UI.createPickerRow({title:"3 - Good",value:"3"}),r[4]=Ti.UI.createPickerRow({title:"2 - Average",value:"2"}),r[5]=Ti.UI.createPickerRow({title:"1 - Poor",value:"1"});var o=Ti.UI.createPicker({bottom:0,selectionIndicator:!0,type:Ti.UI.PICKER_TYPE_PLAIN,zIndex:20});if(o.add(r),t.add(o),"Android"!=Ti.App.Properties.getString("osname")){var m=Titanium.UI.createLabel({text:"Done",color:"#FFF"}),h=Titanium.UI.createButton({systemButton:Titanium.UI.iPhone.SystemButton.FLEXIBLE_SPACE}),v=Titanium.UI.iOS.createToolbar({items:[h,m],bottom:"215",borderTop:!0,borderBottom:!0,barColor:"#2195be",zIndex:"10"});"iPad"==Ti.App.Properties.getString("osname")&&v.setWidth("320"),t.add(v),m.addEventListener("click",function(){{var i=o.getSelectedRow(0).value,a=require("/builders/databaseFunctions/createDatabase"),n=a("/favourites.db","favourites");n.execute('INSERT INTO Favourites ("VenueID", "VenueName", "StarRating", "AddressLine1", "AddressLine2", "Town", "County", "Country", "Postcode", "PackageCode") VALUES ("'+e+'", "'+l+'", "'+i+'", "'+d+'", "'+u+'", "'+c+'", "'+f+'", "'+p+'", "'+g+'", "'+s+'")')}n.close(),t.remove(o),w.setImage("/images/add_favourites_dslctd.png"),t.remove(v)})}else o.addEventListener("change",function(){var i=o.getSelectedRow(0).value;if("0"!=i){{var a=require("/builders/databaseFunctions/createDatabase"),n=a("/favourites.db","favourites");n.execute('INSERT INTO Favourites ("VenueID", "VenueName", "StarRating", "AddressLine1", "AddressLine2", "Town", "County", "Country", "Postcode", "PackageCode") VALUES ("'+e+'", "'+l+'", "'+i+'", "'+d+'", "'+u+'", "'+c+'", "'+f+'", "'+p+'", "'+g+'", "'+s+'")')}n.close(),t.remove(o),w.setImage("/images/add_favourites_dslctd.png")}})}})}}var a=require("/builders/databaseFunctions/createDatabase"),n=a("/venuefinder.db","venuefinder"),r=a("/favourites.db","favourites"),o=n.execute('SELECT * FROM Venue WHERE VenueID="'+e+'"');if(o.isValidRow()){var e=o.fieldByName("VenueID"),s=o.fieldByName("PackageCode"),l=o.fieldByName("VenueName"),d=o.fieldByName("AddressLine1"),u=o.fieldByName("AddressLine2"),c=o.fieldByName("Town"),f=o.fieldByName("County"),p=o.fieldByName("Country"),g=o.fieldByName("Postcode");o.fieldByName("Tel"),o.fieldByName("BookingURL")}var m=null,h=Ti.UI.createView({width:136,height:24,layout:"horizontal",top:0,right:0}),v=r.execute('SELECT * FROM Favourites WHERE VenueID="'+e+'"');v.isValidRow()&&(m=v.fieldByName("VenueID"));var b=Titanium.UI.createLabel({text:"Add to favourites",color:"#000000",top:2,height:20,width:90,font:{fontSize:"11",fontFamily:Ti.App.Properties.getString("fontFamily")},left:0,textAlign:Titanium.UI.TEXT_ALIGNMENT_RIGHT});h.add(b);var T=Titanium.UI.createView({width:40,height:24,top:0,left:6,backgroundColor:"#FFF"}),w=Titanium.UI.createImageView({image:"/images/add_favourites_dslctd.png",width:20,height:18,top:3,left:10});return T.add(w),h.add(T),m!=e&&w.setImage("/images/add_favourites.png"),w.addEventListener("click",function(){i()}),b.addEventListener("click",function(){w.fireEvent("click")}),h}function createMapBtn(e,t,i){function a(){var a=require("/builders/startActInd"),n=a(t);t.setTouchEnabled(!1);var r='SELECT * FROM Venue JOIN VenueCoords ON Venue.VenueID=VenueCoords.VenueID WHERE VenueCoords.VenueID ="'+e+'"',o=require("/views/collview/map/createMapView"),s=o(r,"Venue Map",!1,"Venue Listing","Show on Map",null,null,null,!0,i);s.setWidth(819),s.setHeight(614);var l=Titanium.UI.createWindow({backgroundColor:"rgba(0,0,0,0.8)"}),d=Titanium.UI.createButton({right:"5%",top:"5%",height:"20",zIndex:1,title:"X",color:"#FFF",font:{fontSize:"28",fontWeight:"bold"}});l.add(d),d.addEventListener("click",function(){l.close()});var u=Ti.UI.createView({width:"80%",height:"80%",top:"10%",left:"10%"});u.add(s),l.add(u),l.open();{var c=require("/builders/endActInd");c(t,n[0],n[1])}t.setTouchEnabled(!0)}var n=require("/builders/databaseFunctions/createDatabase"),r=n("/venuefinder.db","venuefinder"),o=r.execute('SELECT * FROM VenueCoords WHERE VenueID="'+e+'"');if(o.isValidRow())var s=o.fieldByName("Latitude"),l=o.fieldByName("Longitude");r.close();var d=Ti.UI.createView({width:136,height:24,layout:"horizontal",top:8,right:0}),u=Titanium.UI.createLabel({text:"Map",color:"#000000",top:2,height:20,width:90,font:{fontSize:"11",fontFamily:Ti.App.Properties.getString("fontFamily")},left:0,textAlign:Titanium.UI.TEXT_ALIGNMENT_RIGHT});d.add(u);var c=Titanium.UI.createView({width:40,height:24,top:0,left:6,backgroundColor:"#FFFFFF"}),f=Titanium.UI.createImageView({image:"/images/show_on_map.png",width:20,height:18,top:3,left:10});return c.add(f),d.add(c),""!=l&&null!=l&&""!=s&&null!=s||(f.setImage("/images/show_on_map_ns.png"),f.setTouchEnabled(!1)),f.addEventListener("click",function(){a()}),u.addEventListener("click",function(){f.fireEvent("click")}),d}function createVenueAdviceBtn(){var e=Ti.UI.createView({width:136,height:24,layout:"horizontal",top:8,right:0}),t=Titanium.UI.createLabel({text:"Venue Advice",color:"#000000",top:2,height:20,width:90,font:{fontSize:"11",fontFamily:Ti.App.Properties.getString("fontFamily")},left:0,textAlign:Titanium.UI.TEXT_ALIGNMENT_RIGHT});e.add(t);var i=Titanium.UI.createView({width:40,height:24,top:0,left:6,backgroundColor:"#FFFFFF"}),a=Titanium.UI.createImageView({image:"/images/venue_advice.png",width:20,height:18,top:3,left:10});return i.add(a),e.add(i),a.addEventListener("click",function(){var e=Titanium.UI.createWindow({backgroundColor:"rgba(0,0,0,0.8)"}),t=Titanium.UI.createButton({right:"5%",top:"5%",height:"20",zIndex:1,title:"X",color:"#FFF",font:{fontSize:"28",fontWeight:"bold"}});e.add(t),t.addEventListener("click",function(){e.close()});var i=Ti.UI.createView({width:"100%",height:"100%"}),a=require("/views/collview/venueFindingService"),n=a(e);i.add(n),e.add(i),e.open()}),t.addEventListener("click",function(){a.fireEvent("click")}),e}function createShareBtn(e){var t=require("/builders/databaseFunctions/createDatabase"),i=t("/venuefinder.db","venuefinder"),a=(t("/favourites.db","favourites"),i.execute('SELECT VenueName FROM Venue WHERE VenueID="'+e+'"'));if(a.isValidRow())var n=a.fieldByName("VenueName");var r=Ti.UI.createView({width:136,height:24,layout:"horizontal",top:8,right:0}),o=Titanium.UI.createLabel({text:"Share",color:"#000000",top:2,height:20,width:90,font:{fontSize:"11",fontFamily:Ti.App.Properties.getString("fontFamily")},left:0,textAlign:Titanium.UI.TEXT_ALIGNMENT_RIGHT});r.add(o);var s=Titanium.UI.createView({width:40,height:24,top:0,left:6,backgroundColor:"#FFFFFF"}),l=Titanium.UI.createImageView({image:"/images/share_button.png",width:20,height:18,top:3,left:10});return s.add(l),r.add(s),l.addEventListener("click",function(){var t=require("/builders/createEmailer"),i=t(null,null,'<a href="http://www.venuefinder.com/venues/v'+e+'">'+n+"</a></br>",null,n,"Venue Listing","Share Venue",null,null),a=Titanium.UI.createWindow({backgroundColor:"rgba(0,0,0,0.8)"}),r=Titanium.UI.createButton({right:"5%",top:"5%",height:"20",zIndex:1,title:"X",color:"#FFF",font:{fontSize:"28",fontWeight:"bold"}});a.add(r),r.addEventListener("click",function(){a.close()});var o=Ti.UI.createView({width:"80%",height:"80%",top:"10%",left:"10%"});o.add(i),a.add(o),a.open()}),o.addEventListener("click",function(){l.fireEvent("click")}),r}function createFloorPlansBtn(e){var t=Ti.UI.createView({width:136,height:24,layout:"horizontal",top:8,right:0}),i=Titanium.UI.createLabel({text:"Floorplans",color:"#000000",top:2,height:20,width:90,font:{fontSize:"11",fontFamily:Ti.App.Properties.getString("fontFamily")},left:0,textAlign:Titanium.UI.TEXT_ALIGNMENT_RIGHT});t.add(i);var a=Titanium.UI.createView({width:40,height:24,top:0,left:6,backgroundColor:"#FFFFFF"}),n=Titanium.UI.createImageView({image:"/images/floorPlansIcon.png",width:20,height:18,top:3,left:10});return a.add(n),t.add(a),n.addEventListener("click",function(){var t=Titanium.UI.createScrollView({top:"0",zIndex:5,layout:"vertical",backgroundColor:"#FFF"}),i=Titanium.UI.createWindow({backgroundColor:"rgba(0,0,0,0.8)"}),a=Ti.UI.createView({width:"60%",height:"60%",top:"10%",left:"20%",layout:"vertical"}),n=Ti.UI.createView({top:0,left:0,height:"15%",width:Ti.UI.FILL,backgroundColor:"#e6a723"}),r=Titanium.UI.createLabel({text:"Floorplans",left:"15",width:"85%",height:"40",top:"15",ellipsize:!0,color:"#ffffff",font:{fontSize:"34",fontFamily:Ti.App.Properties.getString("fontFamily")}});n.add(r);var o=Titanium.UI.createButton({right:"15",top:"10",title:"X",color:"#FFF",font:{fontSize:"28",fontWeight:"bold"}});n.add(o),o.addEventListener("click",function(){i.close()}),a.add(n),a.add(t);var s=require("/builders/databaseFunctions/createDatabase"),l=s("/venuefinder.db","venuefinder"),d=l.execute('SELECT * FROM VenueAdvertOptionsForWeb WHERE VenueID="'+e+'" AND OptionCode = "FLR"');if(d.isValidRow()){var u="http://www.venuefinder.com/adverts/"+d.fieldByName("GraphicFileName"),c=Ti.UI.createWebView({url:"http://docs.google.com/viewer?embedded=true&url="+u});Ti.API.info("http://docs.google.com/viewer?embedded=true&url="+u),t.add(c)}l.close(),i.add(a),i.open()}),t}function createSpeOfferBtn(e){var t=createDatabase("/venuefinder.db","venuefinder"),i=require("/builders/todaysDate"),a=i(),n=!1,r=t.execute('SELECT * FROM Offers WHERE EntryID="'+e+'" AND validToDate>="'+a+'"');0!=r.rowCount&&(n=!0);var o=null;if(n){o=Ti.UI.createView({right:12,bottom:94,width:130,height:50,backgroundColor:"#FFFFFF"});var s=Titanium.UI.createImageView({image:"/images/listing_offers.png",left:12,top:10,width:102,height:"auto"});o.add(s),s.addEventListener("click",function(){var t=Titanium.UI.createScrollView({top:"0%",zIndex:5,layout:"vertical",backgroundColor:"#FFF"}),i=require("/views/children/listingElements/createOffersTab");i(null,null,t,e,null);var a=Titanium.UI.createWindow({backgroundColor:"rgba(0,0,0,0.8)"}),n=Ti.UI.createView({width:"60%",height:"60%",top:"10%",left:"20%",layout:"vertical"}),r=Ti.UI.createView({top:0,left:0,height:"15%",width:Ti.UI.FILL,backgroundColor:"#e6a723"}),o=Titanium.UI.createLabel({text:"Special Offers",left:"15",width:"85%",height:"40",top:"15",ellipsize:!0,color:"#ffffff",font:{fontSize:"34",fontFamily:Ti.App.Properties.getString("fontFamily")}});r.add(o);var s=Titanium.UI.createButton({right:"15",top:"10",title:"X",color:"#FFF",font:{fontSize:"28",fontWeight:"bold"}});r.add(s),s.addEventListener("click",function(){a.close()}),n.add(r),n.add(t),a.add(n),a.open()})}return t.close(),o}module.exports.createFeaturedButtons=createFeaturedButtons,module.exports.createSpeOfferBtn=createSpeOfferBtn;