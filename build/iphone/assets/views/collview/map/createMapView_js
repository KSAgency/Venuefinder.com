function createMapView(e,t,i,a,n,r,o,s,l,d){(null==t||""==t)&&(t="Venue Map");var u;u=Titanium.UI.createView(l?{backgroundColor:"#FFF",title:t,height:Ti.UI.FILL,width:Ti.UI.FILL}:{title:t,width:"340",height:"440",top:"77",left:"20",clipMode:Titanium.UI.iOS.CLIP_MODE_ENABLED});for(var c=require("/builders/todaysDate"),f=(c(),[]),p=require("/builders/databaseFunctions/createDatabase"),g=p("/venuefinder.db","venuefinder"),m=0,h=0,v=require("ti.map"),b=g.execute(e);b.isValidRow();){var T=b.fieldByName("VenueID"),I=b.fieldByName("Latitude"),w=b.fieldByName("Longitude"),y=b.fieldByName("PackageCode"),S=b.fieldByName("VenueName"),A=b.fieldByName("AddressLine1"),E=b.fieldByName("Town"),V=b.fieldByName("County"),C=b.fieldByName("Postcode");if(""!=A&&null!=A)var A=A+", ";else var A="";if(""!=E&&null!=E)var E=E+", ";else var E="";if(""!=V&&null!=V)var V=V+", ";else var V="";if(""!=C&&null!=C)var C=C;else var C="";var L=v.createAnnotation({latitude:I,longitude:w,title:S,subtitle:A+E+V+C,myid:T,packageCode:y});L.setRightButton(Titanium.UI.iPhone.SystemButton.DISCLOSURE),L.setPincolor("FRE"!=y?v.ANNOTATION_RED:v.ANNOTATION_GREEN),f.push(L),m=I.toString(),h=w.toString(),b.next()}var F=v.createView({mapType:v.NORMAL_TYPE,animate:!0,userLocation:!0,zIndex:1,annotations:f});if(F.addEventListener("complete",function(){F.setRegion({latitude:m,longitude:h,latitudeDelta:20.11,longitudeDelta:20.11}),F.removeEventListener("complete",function(){})}),F.addEventListener("click",function(e){if(("rightButton"==e.clicksource||"title"==e.clicksource||"subtitle"==e.clicksource)&&(null==n?n=e.annotation.myid:null!=n&&null==r?r=e.annotation.myid:null!=n&&null!=r&&null==o&&(o=e.annotation.myid),!l)){var t=require("/builders/createApplicationWindow"),i=t(null,null,"Venue Detail",Ti.App.Properties.getString("allWindowsBackgroundColor"),"/images/loading_page.png","Venue Detail","Venue Detail","","","","forflipwindow");d.push(i);var a=require("/builders/startActInd"),s=a(i),u=require("/views/collview/searchView"),c=u(null,i,"",null,"",d);i.add(c[0]),i.add(c[1]),i.add(c[2]),i.add(c[4]);var f=e.annotation.myid,p=e.annotation.packageCode;if("GLD"==p){var g=require("/views/collview/venueDetailPages/createGoldPage"),m=g.createDetailPage(f,i,d);i.add(m)}else if("SIL"==p){var g=require("/views/collview/venueDetailPages/createSilverPage"),h=g.createDetailPage(f,i,d);i.add(h)}else if("BRZ"==p){var g=require("/views/collview/venueDetailPages/createSilverPage"),h=g.createDetailPage(f,i,d);i.add(h)}i.open();{var v=require("/builders/endActInd");v(i,s[0],s[1])}}}),u.add(F),l){var x=Ti.UI.createView({left:-250,bottom:40,width:250,height:233,backgroundColor:"#000",opacity:.8,zIndex:2});l&&u.add(x);var U=Ti.UI.createImageView({image:"/images/map_key.png",color:"#666",opacity:1,width:250,height:233,zIndex:1});x.add(U);var k=Titanium.UI.createView({width:"45%",height:"10%",top:"60%",left:"5%",zIndex:"3"});k.addEventListener("click",function(){F.setMapType(v.NORMAL_TYPE)}),x.add(k);var N=Titanium.UI.createView({width:"55%",height:"10%",top:"72%",left:"5%",zIndex:3});N.addEventListener("click",function(){F.setMapType(v.SATELLITE_TYPE)}),x.add(N);var D=Titanium.UI.createView({width:"50%",height:"10%",top:"85%",left:"5%",zIndex:3});D.addEventListener("click",function(){F.setMapType(v.HYBRID_TYPE)}),x.add(D);var P=Ti.UI.createView({left:0,bottom:40,width:50,height:38,backgroundColor:"transparent",opacity:.8,zIndex:2}),_=Ti.UI.createImageView({image:"/images/mapkey.png",color:"#666",opacity:1,width:50,height:38,zIndex:100,left:"0",top:"0",_left:!1});_.addEventListener("click",function(){1==_._left?(x.animate({left:-250,duration:775}),P.animate({left:0,duration:775}),_._left=!1):(P.animate({left:250,duration:775}),_._left=!0,x.animate({left:0,duration:775}))}),P.add(_),u.add(P)}return g.close(),u}module.exports=createMapView;