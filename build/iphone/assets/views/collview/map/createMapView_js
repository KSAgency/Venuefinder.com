function createMapView(e,t,i,a,n,r,o,s,l,d){(null==t||""==t)&&(t="Venue Map");var u;u=Titanium.UI.createView(l?{backgroundColor:"#FFF",title:t,height:Ti.UI.FILL,width:Ti.UI.FILL}:{title:t,width:Ti.UI.FILL,height:Ti.UI.FILL,top:"77",left:"0",clipMode:Titanium.UI.iOS.CLIP_MODE_ENABLED});for(var c=require("/builders/todaysDate"),f=(c(),[]),p=require("/builders/databaseFunctions/createDatabase"),g=p("/venuefinder.db","venuefinder"),m=0,h=0,v=require("ti.map"),b=g.execute(e);b.isValidRow();){var T=b.fieldByName("VenueID"),w=b.fieldByName("Latitude"),I=b.fieldByName("Longitude"),y=b.fieldByName("PackageCode"),V=b.fieldByName("VenueName"),S=b.fieldByName("AddressLine1"),E=b.fieldByName("Town"),C=b.fieldByName("County"),A=b.fieldByName("Postcode");if(""!=S&&null!=S)var S=S+", ";else var S="";if(""!=E&&null!=E)var E=E+", ";else var E="";if(""!=C&&null!=C)var C=C+", ";else var C="";if(""!=A&&null!=A)var A=A;else var A="";var L=v.createAnnotation({latitude:w,longitude:I,title:V,subtitle:S+E+C+A,myid:T,packageCode:y});"Show on Map"!=n&&L.setRightButton(Titanium.UI.iPhone.SystemButton.DISCLOSURE),L.setPincolor("FRE"!=y?v.ANNOTATION_RED:v.ANNOTATION_GREEN),f.push(L),m=w.toString(),h=I.toString(),b.next()}var x=v.createView({mapType:v.NORMAL_TYPE,animate:!0,userLocation:!0,zIndex:1,annotations:f});if(x.addEventListener("complete",function(){x.setRegion({latitude:m,longitude:h,latitudeDelta:20.11,longitudeDelta:20.11}),x.removeEventListener("complete",function(){})}),x.addEventListener("click",function(e){if(("rightButton"==e.clicksource||"title"==e.clicksource||"subtitle"==e.clicksource)&&(null==n?n=e.annotation.myid:null!=n&&null==r?r=e.annotation.myid:null!=n&&null!=r&&null==o&&(o=e.annotation.myid),!l)){var t=require("/builders/startActInd"),i=t(d[1]),a=require("/builders/createApplicationWindow"),s=a(null,null,"Venue Detail",Ti.App.Properties.getString("allWindowsBackgroundColor"),"/images/loading_page.png","Venue Detail","Venue Detail","","","","forflipwindow");d.push(s);var u=require("/views/collview/searchView"),c=u(null,s,"",null,"",d);s.add(c[0]),s.add(c[1]),s.add(c[2]),s.add(c[4]);var f=e.annotation.myid,p=e.annotation.packageCode;if("GLD"==p){var g=require("/views/collview/venueDetailPages/createGoldPage"),m=g.createDetailPage(f,s,d);s.add(m)}else if("SIL"==p){var g=require("/views/collview/venueDetailPages/createSilverPage"),h=g.createDetailPage(f,s,d);s.add(h)}else if("PRE"==p){var g=require("/views/collview/venueDetailPages/createSilverPage"),h=g.createDetailPage(f,s,d);s.add(h)}s.open();{var v=require("/builders/endActInd");v(d[1],i[0],i[1])}}}),u.add(x),l){var F=Ti.UI.createView({left:-250,bottom:40,width:250,height:233,backgroundColor:"#000",opacity:.8,zIndex:2});l&&u.add(F);var U=Ti.UI.createImageView({image:"/images/map_key.png",color:"#666",opacity:1,width:250,height:233,zIndex:1});F.add(U);var N=Titanium.UI.createView({width:"45%",height:"10%",top:"60%",left:"5%",zIndex:"3"});N.addEventListener("click",function(){x.setMapType(v.NORMAL_TYPE)}),F.add(N);var k=Titanium.UI.createView({width:"55%",height:"10%",top:"72%",left:"5%",zIndex:3});k.addEventListener("click",function(){x.setMapType(v.SATELLITE_TYPE)}),F.add(k);var D=Titanium.UI.createView({width:"50%",height:"10%",top:"85%",left:"5%",zIndex:3});D.addEventListener("click",function(){x.setMapType(v.HYBRID_TYPE)}),F.add(D);var R=Ti.UI.createView({left:0,bottom:40,width:50,height:38,backgroundColor:"transparent",opacity:.8,zIndex:2}),O=Ti.UI.createImageView({image:"/images/mapkey.png",color:"#666",opacity:1,width:50,height:38,zIndex:100,left:"0",top:"0",_left:!1});O.addEventListener("click",function(){1==O._left?(F.animate({left:-250,duration:775}),R.animate({left:0,duration:775}),O._left=!1):(R.animate({left:250,duration:775}),O._left=!0,F.animate({left:0,duration:775}))}),R.add(O),u.add(R)}return g.close(),u}module.exports=createMapView;