<<<<<<< HEAD
function offersView(e,t,i){var a=Titanium.UI.createWindow({backgroundColor:i,title:t,width:Ti.UI.FILL,height:Ti.UI.FILL});"Android"!=Ti.App.Properties.getString("osname")&&(a.setBarColor("#2195be"),a.setBackButtonTitle("Back"),a.setTintColor("#FFF"),a.setTranslucent(!1),a.setTitleControl(Ti.UI.createLabel({text:t,color:"#FFF",width:Ti.UI.SIZE})));var n=Titanium.UI.createWebView({opacity:0,width:0,height:0,left:0,right:0,touchEnabled:!1});a.add(n);Titanium.Geolocation.purpose="Pinpoint you on the map",Titanium.Geolocation.accuracy=Titanium.Geolocation.ACCURACY_BEST,Titanium.Geolocation.frequency=5e3;var r=Titanium.UI.createView({width:Ti.UI.FILL,height:90,top:0}),o=Titanium.UI.createImageView({image:"/images/update_offers.png",top:10,width:300,height:54}),s=Titanium.UI.createLabel({text:"or, fill out the form below",color:"#666",width:300,textAlign:"center",font:{fontFamily:"Arial",fontSize:"14px"},zIndex:"3",top:70});"iPad"==Ti.App.Properties.getString("osname")&&(o.setWidth(216),o.setHeight(39),o.setLeft(0),o.setTop(10),s.setTop(20)),r.add(o),r.add(s),o.addEventListener("click",function(){var e=Titanium.UI.createAlertDialog({title:"Update Information",message:"There are over 15,000 venues on our database, so we recommend that you update the listings via a WiFi connection.",buttonNames:["Update Later","Update Now"]});e.show(),e.addEventListener("click",function(e){if(1==e.index&&1==Ti.Network.online){var t=require("/builders/databaseFunctions/update/updateDatabase");t("specialoffers",null)}else if(1==e.index&&0==Ti.Network.online){var i=Titanium.UI.createAlertDialog({title:"Error Updating",message:"Please ensure you are connected to the internet via a WiFi or 3G connection, once completed please try again.",buttonNames:["Close"]});i.show()}})});var l=[],d=require("/builders/todaysDate"),u=d(),c='SELECT COUNT(Country) AS VenueCount FROM Venue JOIN Offers ON Venue.VenueID=Offers.EntryID WHERE (Country="England" OR Country="Wales" OR Country="Scotland" OR Country="Northern Ireland" OR Country="Channel Islands" OR Country="Isle of Man") AND Country IS NOT NULL AND LTRIM(Country)!="" AND Offers.ValidToDate>="'+u+'" ORDER BY Country ASC',f='SELECT Venue.Country, COUNT(Country) AS VenueCount FROM Venue JOIN Offers ON Venue.VenueID=Offers.EntryID WHERE Country IS NOT NULL AND LTRIM(Country)!="" AND Offers.ValidToDate>="'+u+'" GROUP BY Country ORDER BY Country ASC',p="SELECT Venue.County, COUNT(County) AS VenueCount FROM Venue JOIN Offers ON Venue.VenueID=Offers.EntryID WHERE (",m=') AND County IS NOT NULL AND LTRIM(County)!="" AND validToDate>="'+u+'" AND Venue.PackageCode!="FRE" GROUP BY County ORDER BY County ASC',g=require("/builders/databaseFunctions/createCountryCountyList"),h=g(e,c,f,p,m),v=require("/builders/databaseFunctions/createDoubleField"),T=require("/builders/databaseFunctions/createCheckField"),b=v("Venue Town","Example Town"),I=T("Christmas Offers"),w=T("Wedding Offers");l.push(h[0]),l.push(h[1]),l.push(b[0]),l.push(I[0]),l.push(w[0]);var y=require("/builders/submitButtonStyle"),E=y();E.addEventListener("click",function(){var t=require("/builders/startActInd"),i=t(a),n=b[1].getValue(),r='SELECT * FROM Venue JOIN Offers ON Venue.VenueID=Offers.EntryID WHERE EntryID IS NOT NULL AND validToDate>="'+u+'"',o="",s="",l="",d="",c="";if(1==w[0].checkValue){var f=!0;isWedOff="1";var d=' AND WeddingOffer="'+w[0].checkValue+'"'}if(1==I[0].checkValue){var f=!0;isXmasOff="1";var c=' AND ChristmasOffer="'+I[0].checkValue+'"'}if("Choose a Country"!=h[0].title&&"United Kingdom"!=h[0].title)var o=' AND Country="'+h[0].title+'"',f=!0;if("United Kingdom"==h[0].title)var o=' AND (Country="United Kingdom" OR Country="England" OR Country="Scotland" OR Country="Wales" OR Country="Northern Ireland" OR Country="Channel Islands" OR Country="Isle of Man")',f=!0;if("Choose a County"!=h[1].title)var s=' AND County="'+h[1].title+'"',f=!0;if(""!=n)var l=' AND Town LIKE "%'+n+'%"',f=!0;var p=r+o+s+l+d+c,m=require("/builders/createResultsPage"),g=m(a,e,p,f,null,null,!1,!0);e.activeTab.open(g);{var v=require("/builders/endActInd");v(a,i[0],i[1])}});var S=Titanium.UI.createTableView({style:Titanium.UI.iPhone.TableViewStyle.GROUPED,data:l,backgroundColor:"#d2e8f5",footerView:E,top:10});"iPad"!=Ti.App.Properties.getString("osname")&&S.setWidth(300),0==Ti.App.Properties.getString("updatedOffers")&&S.setHeaderView(r),"iPad"==Ti.App.Properties.getString("osname")&&(S.setWidth(600),S.setScrollable(!1),S.setTop(50)),a.add(S);var A=require("/builders/createAdvert"),C=A();return a.add(C),a}module.exports=offersView;
=======
function offersView(e,t,i){var a=Titanium.UI.createWindow({backgroundColor:i,title:t,width:Ti.UI.FILL,height:Ti.UI.FILL});"Android"!=Ti.App.Properties.getString("osname")&&(a.setBarColor("#2195be"),a.setBackButtonTitle("Back"),a.setTintColor("#FFF"),a.setTranslucent(!1),a.setTitleControl(Ti.UI.createLabel({text:t,color:"#FFF",width:Ti.UI.SIZE})));var n=Titanium.UI.createWebView({opacity:0,width:0,height:0,left:0,right:0,touchEnabled:!1});a.add(n);Titanium.Geolocation.purpose="Pinpoint you on the map",Titanium.Geolocation.accuracy=Titanium.Geolocation.ACCURACY_BEST,Titanium.Geolocation.frequency=5e3;var r=Titanium.UI.createView({width:Ti.UI.FILL,height:90,top:0}),o=Titanium.UI.createImageView({image:"/images/update_offers.png",top:10,width:300,height:54}),s=Titanium.UI.createLabel({text:"or, fill out the form below",color:"#666",width:300,textAlign:"center",font:{fontFamily:"Arial",fontSize:"14px"},zIndex:"3",top:70});"iPad"==Ti.App.Properties.getString("osname")&&(o.setWidth(216),o.setHeight(39),o.setLeft(0),o.setTop(10),s.setTop(20)),r.add(o),r.add(s),o.addEventListener("click",function(){var e=Titanium.UI.createAlertDialog({title:"Update Information",message:"There are over 15,000 venues on our database, so we recommend that you update the listings via a WiFi connection.",buttonNames:["Update Later","Update Now"]});e.show(),e.addEventListener("click",function(e){if(1==e.index&&1==Ti.Network.online){var t=require("/builders/databaseFunctions/update/updateDatabase");t("specialoffers",null)}else if(1==e.index&&0==Ti.Network.online){var i=Titanium.UI.createAlertDialog({title:"Error Updating",message:"Please ensure you are connected to the internet via a WiFi or 3G connection, once completed please try again.",buttonNames:["Close"]});i.show()}})});var l=[],d=require("/builders/todaysDate"),u=d(),c='SELECT COUNT(Country) AS VenueCount FROM Venue JOIN Offers ON Venue.VenueID=Offers.EntryID WHERE (Country="England" OR Country="Wales" OR Country="Scotland" OR Country="Northern Ireland" OR Country="Channel Islands" OR Country="Isle of Man") AND Country IS NOT NULL AND LTRIM(Country)!="" AND Offers.ValidToDate>="'+u+'" ORDER BY Country ASC',f='SELECT Venue.Country, COUNT(Country) AS VenueCount FROM Venue JOIN Offers ON Venue.VenueID=Offers.EntryID WHERE Country IS NOT NULL AND LTRIM(Country)!="" AND Offers.ValidToDate>="'+u+'" GROUP BY Country ORDER BY Country ASC',p="SELECT Venue.County, COUNT(County) AS VenueCount FROM Venue JOIN Offers ON Venue.VenueID=Offers.EntryID WHERE (",m=') AND County IS NOT NULL AND LTRIM(County)!="" AND validToDate>="'+u+'" AND Venue.PackageCode!="FRE" GROUP BY County ORDER BY County ASC',g=require("/builders/databaseFunctions/createCountryCountyList"),h=g(e,c,f,p,m),v=require("/builders/databaseFunctions/createDoubleField"),T=require("/builders/databaseFunctions/createCheckField"),b=v("Venue Town","Example Town"),I=T("Christmas Offers"),w=T("Wedding Offers");l.push(h[0]),l.push(h[1]),l.push(b[0]),l.push(I[0]),l.push(w[0]);var y=require("/builders/submitButtonStyle"),E=y();E.addEventListener("click",function(){var t=require("/builders/startActInd"),i=t(a),n=b[1].getValue(),r='SELECT * FROM Venue JOIN Offers ON Venue.VenueID=Offers.EntryID WHERE EntryID IS NOT NULL AND validToDate>="'+u+'"',o="",s="",l="",d="",c="";if(1==w[0].checkValue){var f=!0;isWedOff="1";var d=' AND WeddingOffer="'+w[0].checkValue+'"'}if(1==I[0].checkValue){var f=!0;isXmasOff="1";var c=' AND ChristmasOffer="'+I[0].checkValue+'"'}if("Choose a Country"!=h[0].title&&"United Kingdom"!=h[0].title)var o=' AND Country="'+h[0].title+'"',f=!0;if("United Kingdom"==h[0].title)var o=' AND (Country="United Kingdom" OR Country="England" OR Country="Scotland" OR Country="Wales" OR Country="Northern Ireland" OR Country="Channel Islands" OR Country="Isle of Man")',f=!0;if("Choose a County"!=h[1].title)var s=' AND County="'+h[1].title+'"',f=!0;if(""!=n)var l=' AND Town LIKE "%'+n+'%"',f=!0;var p=r+o+s+l+d+c,m=require("/builders/createResultsPage"),g=m(a,e,p,f,null,null,!1,!0);e.activeTab.open(g);{var v=require("/builders/endActInd");v(a,i[0],i[1])}});var S=Titanium.UI.createTableView({style:Titanium.UI.iPhone.TableViewStyle.GROUPED,data:l,backgroundColor:"#d2e8f5",footerView:E,top:10});"iPad"!=Ti.App.Properties.getString("osname")&&S.setWidth(300),0==Ti.App.Properties.getString("updatedOffers")&&S.setHeaderView(r),"iPad"==Ti.App.Properties.getString("osname")&&(S.setWidth(600),S.setScrollable(!1),S.setTop(50)),a.add(S);var A=require("/builders/createAdvert"),C=A();return a.add(C),offersView.home_button.addEventListener("click",function(){b[1].blur()}),a}module.exports=offersView;
>>>>>>> FETCH_HEAD
