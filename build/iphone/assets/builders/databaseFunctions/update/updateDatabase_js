function updateDatabase(e,t){if(1==Ti.Network.online){var i=Titanium.Filesystem.getFile(Titanium.Filesystem.tempDirectory,"/"+e+".zip");if(null!=t&&""!=t){var a=Titanium.UI.createView({width:150,height:150,backgroundColor:"#000",opacity:.75,borderRadius:"15%",zIndex:20}),n=Titanium.UI.createLabel({font:{fontSize:11,fontFamily:"Arial",fontWeight:"bold"},text:"Checking network status",color:"#FFFFFF",title:"0%"});a.add(n),t.add(a)}var o=Titanium.Network.createHTTPClient({ondatastream:function(e){if(null!=t&&""!=t){var i=e.progress;i=100*i,i=i.toString(),i=i.substr(0,4),n.setText(i+"%")}},onload:function(){i.write(o.responseData);var n=require("ti.compression"),r=Titanium.Filesystem.tempDirectory,l=r+"/"+e+".zip",d=n.unzip(r,l,!0);if("success"==d){if("Android"==Ti.App.Properties.getString("osname"))var u=Ti.Filesystem.getFile("file:///data/data/"+Ti.App.getID()+"/databases/",e);else{var s=require("/builders/databaseFunctions/createDatabase"),c=s("/"+e+".db",e),u=c.getFile();c.close()}u.exists()&&u.deleteFile();var s=require("/builders/databaseFunctions/createDatabase"),f=s(Titanium.Filesystem.tempDirectory+"/"+e+".db",e);f.close();var s=require("/builders/databaseFunctions/createDatabase"),m=s("/venuefinder.db","venuefinder",!0);m.close(),null!=a&&""!=a&&t.remove(a);var p=Titanium.Filesystem.getFile(Titanium.Filesystem.tempDirectory,"/"+e+".zip"),T=Titanium.Filesystem.getFile(Titanium.Filesystem.tempDirectory,"/"+e+".db");p.deleteFile(),T.deleteFile(),"specialoffers"==e&&Ti.App.Properties.setString("updatedOffers",!0)}else alert("specialoffers"==e?"We were unable to get the latest offers, please manually update the offers from the offers tab":"We were unable to download the latest update, please ensure you are connected to a WiFi or 3G Network and try again"),Ti.App.Properties.setString("updatedOffers",!1)},timeout:5e3});o.open("GET","http://venuefindermobile.live.x-rm.com/data/"+e+".zip"),o.send()}}module.exports=updateDatabase;