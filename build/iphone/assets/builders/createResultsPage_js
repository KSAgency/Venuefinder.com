function createResultsPage(e,t,i,a,n,o,r,l,d,s,u,c,f,m){function g(){var t=require("/builders/startActInd"),i=t(F);null!=e&&e.setTouchEnabled(!1),p+=v,I+=1,T(),"iPad"!=Ti.App.Properties.getString("osname")?P.setData(L):(P.removeAllChildren(),P.add(L));{var a=require("/builders/endActInd");a(F,i[0],i[1])}null!=e&&e.setTouchEnabled(!0)}function h(){var t=require("/builders/startActInd"),i=t(F);null!=e&&e.setTouchEnabled(!1),p-=v,I-=1,T(),"iPad"!=Ti.App.Properties.getString("osname")?P.setData(L):(P.removeAllChildren(),P.add(L));{var a=require("/builders/endActInd");a(F,i[0],i[1])}null!=e&&e.setTouchEnabled(!0)}function T(){L=[];for(var e=require("/builders/databaseFunctions/createDatabase"),a=e("/venuefinder.db","venuefinder"),n=a.execute(i+E+S+v+" OFFSET "+p);n.isValidRow();)!function(){var e=n.fieldByName("VenueID"),i=n.fieldByName("PackageCode"),o=n.fieldByName("VenueName"),r=n.fieldByName("Town"),m=n.fieldByName("Country");if(0!=r.length&&null!=r)var r=r+", ";else var r="";var g=(n.fieldByName("MeetingRoomDisabledAccess"),n.fieldByName("BedroomsNo")),h=n.fieldByName("BedroomDisabledAccess"),T=n.fieldByName("PackageCode");if(1==l){var p=n.fieldByName("summaryText"),I=(n.fieldByName("bodyText"),n.fieldByName("validFromDate"));validForm=I.toString(),I=I.substr(0,10),I=I.split("-");var v=I[0].toString(),b=I[1].toString()-1,w=I[2].toString();I=new Date(v,b,w),I=I.toString(),I=I.substr(0,15);var E=n.fieldByName("validToDate");E=E.toString(),E=E.substr(0,10),E=E.split("-");var S=E[0].toString(),A=E[1].toString()-1,U=E[2].toString();E=new Date(S,A,U),E=E.toString(),E=E.substr(0,15)}var y=null;if("PRE"==T){var P=a.execute('SELECT Text FROM VenueAdvertOptionsForWeb WHERE VenueID="'+e+'" AND OptionCode="SG2"');P.isValidRow()&&(y=P.fieldByName("Text"))}else{var P=a.execute('SELECT DescriptionText FROM VenueTextForWeb WHERE VenueID="'+e+'"');P.isValidRow()&&(y=P.fieldByName("DescriptionText"))}(null==y||""==y)&&(y="No description could be retrieved for this venue."),y.toString(),y=y.replace(/(<([^>]+)>)/gi,""),y=y.replace(/\s+/g," "),y=y.replace(/(&amp;)/g,"&"),y=y.replace(/(&nbsp;)/g," "),y=y.replace(/(&rsquo;)/g,"’"),y=y.replace(/(&hellip;)/g,"…"),y=y.replace(/(&oslash;)/g,"Ø"),y=y.replace(/(&pound;)/g,"£"),y=y.replace(/(&ndash;)/g,"–"),y=y.replace(/(&sup2;)/g,"²"),y=y.replace(/(&ldquo;)/g,"“"),y=y.replace(/(&rdquo;)/g,"”"),y=y.replace(/(&lsquo;)/g,"’");var N=a.execute('SELECT * FROM VenueAdvertOptionsForWeb WHERE VenueID="'+e+'" AND (OptionCode="TOP" OR OptionCode="PIC")');if(N.isValidRow())var C=N.fieldByName("GraphicFileName");if("FRE"==i)var V="freeResultsFormat";else var V="featuredResultsFormat";var R=[];if(1==l?(V="offersResultsFormat",R[0]=o,R[1]=e,R[2]=C,R[3]=r,R[4]=m,R[5]=p,R[6]=I,R[7]=E,R[8]=null):(R=[],R[0]=o,R[1]=e,R[2]=C,R[3]=g,R[4]=h,R[5]=y,R[6]=r,R[7]=m,R[8]=null==f?null:f),"FRE"==i){var k=require("/builders/"+V),O=k(o,e,r,m);L.push(O)}else{var k=require("/builders/"+V),O=k(R[0],R[1],R[2],R[3],R[4],R[5],R[6],R[7],R[8]);L.push(O)}n.next(),O.addEventListener("click",function(e){var i=require("/builders/startActInd"),a=i(F);if("iPad"!=Ti.App.Properties.getString("osname"))var n=e.rowData;else var n=e.source;var o=null;"offersResultsFormat"==V?o="Offers":"Videos"==d&&(o="Media"),null==s?s=n.uniqueID:null!=s&&null==u?u=n.uniqueID:null!=s&&null!=u&&null==c&&(c=n.uniqueID);{var r=require("/builders/createApplicationWindow"),l=(r(t,"children/featuredListing",n.venueTitle,"#FFF",d,s,u,c,n.uniqueID,o),require("/builders/endActInd"));l(F,a[0],a[1])}})}();if("iPad"==Ti.App.Properties.getString("osname"))var o=Titanium.UI.createView({height:"60",width:"1000",left:"10",top:"10"}),r=Titanium.UI.createButton({title:"Next Page",color:"#999",borderRadius:10,borderColor:"#999",backgroundColor:"#FFF",height:50,width:327,right:0,top:0}),m=Titanium.UI.createButton({title:"Go Back",color:"#999",borderRadius:10,borderColor:"#999",backgroundColor:"#FFF",height:50,width:327,left:0,top:0});else{var o=Titanium.UI.createTableViewRow({height:70}),r=Titanium.UI.createButton({title:"Next Page",color:"#999",height:40,width:140,right:10}),m=Titanium.UI.createButton({title:"Go Back",color:"#999",height:40,width:140,left:10});"Android"==Ti.App.Properties.getString("osname")&&(r.setColor("#333"),m.setColor("#333"))}0!=I&&o.add(m),p+L.length<U&&o.add(r),L.push(o),r.addEventListener("click",function(){g(o)}),m.addEventListener("click",function(){h()}),a.close()}var p=0,I=0,v=10;"iPad"==Ti.App.Properties.getString("osname")&&(v=12),null!=m&&(v=m);var b=require("/builders/databaseFunctions/createDatabase"),w=b("/venuefinder.db","venuefinder");if(0==r)var E=' AND PackageCode!="FRE" ';else var E="";if(1==l)var S=" ORDER BY Offers.CreatedDate DESC LIMIT ";else var S=" ORDER BY PackageOrder ASC, VenueSort ASC LIMIT ";var A=w.execute(i+E),U=A.rowCount;if(w.close(),1==a&&0!=U){var L=[],y=require("/builders/createApplicationWindow"),F=y(t,null,"Search Results ("+U+")","#FFF","Search","Venue Search","Search Results",null);if(F.addEventListener("close",function(){p=0}),T(),"iPad"!=Ti.App.Properties.getString("osname"))var P=Titanium.UI.createTableView({data:L,separatorColor:"#999"});else{var P=Titanium.UI.createScrollView({layout:"horizontal",horizontalWrap:!0,backgroundColor:"#d2e8f5",contentWidth:Ti.UI.FILL,height:"100%",width:"100%"});P.add(L)}null!=n&&""!=n&&(o.hide(),e.remove(n),e.setTouchEnabled(!0)),F.add(P)}else{var y=require("/builders/createApplicationWindow"),F=y(t,null,"No Search Results","#d2e8f5",null,null,null,null),N=Titanium.UI.createLabel({text:"Please fill out one or more of the form fields",color:"#999",font:{fontFamily:"Arial",fontSize:18},width:290,left:15,textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER});0==U&&N.setText("Your search returned no results, please try again with a different search term."),F.add(N),null!=n&&""!=n&&(o.hide(),e.remove(n),e.setTouchEnabled(!0))}return F}module.exports=createResultsPage;