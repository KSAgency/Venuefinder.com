function createResultsPage(e,t,i,a,n,o,r,l,d,u,s,c,f,m){function T(){var t=require("/builders/startActInd"),i=t(L);null!=e&&e.setTouchEnabled(!1),p+=v,I+=1,g(),"iPad"!=Ti.App.Properties.getString("osname")?y.setData(U):(y.removeAllChildren(),y.add(U));{var a=require("/builders/endActInd");a(L,i[0],i[1])}null!=e&&e.setTouchEnabled(!0)}function h(){var t=require("/builders/startActInd"),i=t(L);null!=e&&e.setTouchEnabled(!1),p-=v,I-=1,g(),"iPad"!=Ti.App.Properties.getString("osname")?y.setData(U):(y.removeAllChildren(),y.add(U));{var a=require("/builders/endActInd");a(L,i[0],i[1])}null!=e&&e.setTouchEnabled(!0)}function g(){U=[];for(var e=require("/builders/databaseFunctions/createDatabase"),a=e("/venuefinder.db","venuefinder"),n=a.execute(i+S+"ORDER BY PackageOrder ASC, VenueSort ASC LIMIT "+v+" OFFSET "+p);n.isValidRow();)!function(){var e=n.fieldByName("VenueID"),i=n.fieldByName("PackageCode"),o=n.fieldByName("VenueName"),r=n.fieldByName("Town"),m=n.fieldByName("Country");if(0!=r.length&&null!=r)var r=r+", ";else var r="";var T=(n.fieldByName("MeetingRoomDisabledAccess"),n.fieldByName("BedroomsNo")),h=n.fieldByName("BedroomDisabledAccess"),g=n.fieldByName("PackageCode");if(1==l){var p=n.fieldByName("summaryText"),I=(n.fieldByName("bodyText"),n.fieldByName("validFromDate"));validForm=I.toString(),I=I.substr(0,10),I=I.split("-");var v=I[0].toString(),b=I[1].toString()-1,w=I[2].toString();I=new Date(v,b,w),I=I.toString(),I=I.substr(0,15);var S=n.fieldByName("validToDate");S=S.toString(),S=S.substr(0,10),S=S.split("-");var E=S[0].toString(),A=S[1].toString()-1,F=S[2].toString();S=new Date(E,A,F),S=S.toString(),S=S.substr(0,15)}var y=null;if("PRE"==g){var N=a.execute('SELECT Text FROM VenueAdvertOptionsForWeb WHERE VenueID="'+e+'" AND OptionCode="SG2"');N.isValidRow()&&(y=N.fieldByName("Text"))}else{var N=a.execute('SELECT DescriptionText FROM VenueTextForWeb WHERE VenueID="'+e+'"');N.isValidRow()&&(y=N.fieldByName("DescriptionText"))}(null==y||""==y)&&(y="No description could be retrieved for this venue."),y.toString(),y=y.replace(/(<([^>]+)>)/gi,""),y=y.replace(/\s+/g," "),y=y.replace(/(&amp;)/g,"&"),y=y.replace(/(&nbsp;)/g," "),y=y.replace(/(&rsquo;)/g,"’"),y=y.replace(/(&hellip;)/g,"…"),y=y.replace(/(&oslash;)/g,"Ø"),y=y.replace(/(&pound;)/g,"£"),y=y.replace(/(&ndash;)/g,"–"),y=y.replace(/(&sup2;)/g,"²"),y=y.replace(/(&ldquo;)/g,"“"),y=y.replace(/(&rdquo;)/g,"”"),y=y.replace(/(&lsquo;)/g,"’");var V=a.execute('SELECT * FROM VenueAdvertOptionsForWeb WHERE VenueID="'+e+'" AND (OptionCode="TOP" OR OptionCode="PIC")');if(V.isValidRow())var P=V.fieldByName("GraphicFileName");if("FRE"==i)var k="freeResultsFormat";else var k="featuredResultsFormat";var C=[];if(1==l?(k="offersResultsFormat",C[0]=o,C[1]=e,C[2]=P,C[3]=r,C[4]=m,C[5]=p,C[6]=I,C[7]=S,C[8]=null):(C=[],C[0]=o,C[1]=e,C[2]=P,C[3]=T,C[4]=h,C[5]=y,C[6]=r,C[7]=m,C[8]=null==f?null:f),"FRE"==i){var O=require("/builders/"+k),R=O(o,e,r,m);U.push(R)}else{var O=require("/builders/"+k),R=O(C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7],C[8]);U.push(R)}n.next(),R.addEventListener("click",function(e){var i=require("/builders/startActInd"),a=i(L);if("iPad"!=Ti.App.Properties.getString("osname"))var n=e.rowData;else var n=e.source;var o=null;"offersResultsFormat"==k?o="Offers":"Videos"==d&&(o="Media"),null==u?u=n.uniqueID:null!=u&&null==s?s=n.uniqueID:null!=u&&null!=s&&null==c&&(c=n.uniqueID);{var r=require("/builders/createApplicationWindow"),l=(r(t,"children/featuredListing",n.venueTitle,"#FFF",d,u,s,c,n.uniqueID,o),require("/builders/endActInd"));l(L,a[0],a[1])}})}();if("iPad"==Ti.App.Properties.getString("osname"))var o=Titanium.UI.createView({height:"60",width:"1000",left:"10",top:"10"}),r=Titanium.UI.createButton({title:"Next Page",color:"#999",borderRadius:10,borderColor:"#999",backgroundColor:"#FFF",height:50,width:327,right:0,top:0}),m=Titanium.UI.createButton({title:"Go Back",color:"#999",borderRadius:10,borderColor:"#999",backgroundColor:"#FFF",height:50,width:327,left:0,top:0});else{var o=Titanium.UI.createTableViewRow({height:70}),r=Titanium.UI.createButton({title:"Next Page",color:"#999",height:40,width:140,right:10}),m=Titanium.UI.createButton({title:"Go Back",color:"#999",height:40,width:140,left:10});"Android"==Ti.App.Properties.getString("osname")&&(r.setColor("#333"),m.setColor("#333"))}0!=I&&o.add(m),p+U.length<A&&o.add(r),U.push(o),r.addEventListener("click",function(){T(o)}),m.addEventListener("click",function(){h()}),a.close()}var p=0,I=0,v=10;"iPad"==Ti.App.Properties.getString("osname")&&(v=12),null!=m&&(v=m);var b=require("/builders/databaseFunctions/createDatabase"),w=b("/venuefinder.db","venuefinder");if(0==r)var S=' AND PackageCode!="FRE" ';else var S="";var E=w.execute(i+S),A=E.rowCount;if(w.close(),1==a&&0!=A){var U=[],F=require("/builders/createApplicationWindow"),L=F(t,null,"Search Results ("+A+")","#FFF","Search","Venue Search","Search Results",null);if(Ti.API.info(L),L.addEventListener("close",function(){p=0}),g(),"iPad"!=Ti.App.Properties.getString("osname"))var y=Titanium.UI.createTableView({data:U});else{var y=Titanium.UI.createScrollView({layout:"horizontal",horizontalWrap:!0,backgroundColor:"#d2e8f5",contentWidth:Ti.UI.FILL,height:"100%",width:"100%"});y.add(U)}null!=n&&""!=n&&(o.hide(),e.remove(n),e.setTouchEnabled(!0)),L.add(y)}else{var F=require("/builders/createApplicationWindow"),L=F(t,null,"No Search Results","#d2e8f5",null,null,null,null),N=Titanium.UI.createLabel({text:"Please fill out one or more of the form fields",color:"#999",font:{fontFamily:"Arial",fontSize:18}});0==A&&N.setText("Your search returned no results, please try again with a different search term."),L.add(N),null!=n&&""!=n&&(o.hide(),e.remove(n),e.setTouchEnabled(!0))}return L}module.exports=createResultsPage;